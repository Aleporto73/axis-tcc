module.exports=[61419,e=>{"use strict";e.i(78417);var t=e.i(38090),a=e.i(15484);e.i(79640);var r=e.i(39184);e.i(10698),e.i(52119),e.i(80508),e.i(39345),e.i(87442),e.i(31112);var s=e.i(31293),n=e.i(62790),i=class{#e;#t=864e5;constructor(e){this.#e=e}isEventThrottled(e){let t=Date.now(),a=this.#a(e),r=this.#e.getItem(a);return!!r&&!(t-r>this.#t)||(this.#e.setItem(a,t),!1)}#a(e){let{sk:t,pk:a,payload:r,...s}=e,n={...r,...s};return JSON.stringify(Object.keys({...r,...s}).sort().map(e=>n[e]))}},l=class{#r="clerk_telemetry_throttler";getItem(e){return this.#s()[e]}setItem(e,t){try{let a=this.#s();a[e]=t,localStorage.setItem(this.#r,JSON.stringify(a))}catch(e){e instanceof DOMException&&("QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&localStorage.length>0&&localStorage.removeItem(this.#r)}}removeItem(e){try{let t=this.#s();delete t[e],localStorage.setItem(this.#r,JSON.stringify(t))}catch{}}#s(){try{let e=localStorage.getItem(this.#r);if(!e)return{};return JSON.parse(e)}catch{return{}}}static isSupported(){return!1}},o=class{#e=new Map;#n=1e4;getItem(e){return this.#e.size>this.#n?void this.#e.clear():this.#e.get(e)}setItem(e,t){this.#e.set(e,t)}removeItem(e){this.#e.delete(e)}};let d=new Set(["error","warn","info","debug","trace"]);var c=class{#i;#l;#o={};#d=[];#c=null;constructor(e){this.#i={maxBufferSize:e.maxBufferSize??5,samplingRate:e.samplingRate??1,perEventSampling:e.perEventSampling??!0,disabled:e.disabled??!1,debug:e.debug??!1,endpoint:"https://clerk-telemetry.com"},e.clerkVersion?this.#o.clerkVersion=e.clerkVersion??"":this.#o.clerkVersion="",this.#o.sdk=e.sdk,this.#o.sdkVersion=e.sdkVersion,this.#o.publishableKey=e.publishableKey??"";const t=(0,s.parsePublishableKey)(e.publishableKey);t&&(this.#o.instanceType=t.instanceType),e.secretKey&&(this.#o.secretKey=e.secretKey.substring(0,16)),this.#l=new i(l.isSupported()?new l:new o)}get isEnabled(){return!("development"!==this.#o.instanceType||this.#i.disabled||"u">typeof process&&process.env&&(0,n.isTruthy)(process.env.CLERK_TELEMETRY_DISABLED))}get isDebug(){return this.#i.debug||"u">typeof process&&process.env&&(0,n.isTruthy)(process.env.CLERK_TELEMETRY_DEBUG)}record(e){try{let t=this.#u(e.event,e.payload);if(this.#h(t.event,t),!this.#p(t,e.eventSamplingRate))return;this.#d.push({kind:"event",value:t}),this.#g()}catch(e){console.error("[clerk/telemetry] Error recording telemetry event",e)}}recordLog(e){try{if(!this.#m(e))return;let t="string"==typeof e?.level&&d.has(e.level),a="string"==typeof e?.message&&e.message.trim().length>0,r=null,s=e?.timestamp;if("number"==typeof s||"string"==typeof s){let e=new Date(s);Number.isNaN(e.getTime())||(r=e)}if(!t||!a||null===r){this.isDebug&&"u">typeof console&&console.warn("[clerk/telemetry] Dropping invalid telemetry log entry",{levelIsValid:t,messageIsValid:a,timestampIsValid:null!==r});return}let n=this.#y(),i={sdk:n.name,sdkv:n.version,cv:this.#o.clerkVersion??"",lvl:e.level,msg:e.message,ts:r.toISOString(),pk:this.#o.publishableKey||null,payload:this.#v(e.context)};this.#d.push({kind:"log",value:i}),this.#g()}catch(e){console.error("[clerk/telemetry] Error recording telemetry log entry",e)}}#p(e,t){return this.isEnabled&&!this.isDebug&&this.#f(e,t)}#m(e){return!0}#f(e,t){let a=Math.random();return!!(a<=this.#i.samplingRate&&(!1===this.#i.perEventSampling||void 0===t||a<=t))&&!this.#l.isEventThrottled(e)}#g(){this.#E()}#E(){let e=[...this.#d];if(this.#d=[],this.#c=null,0===e.length)return;let t=e.filter(e=>"event"===e.kind).map(e=>e.value),a=e.filter(e=>"log"===e.kind).map(e=>e.value);t.length>0&&fetch(new URL("/v1/event",this.#i.endpoint),{headers:{"Content-Type":"application/json"},keepalive:!0,method:"POST",body:JSON.stringify({events:t})}).catch(()=>void 0),a.length>0&&fetch(new URL("/v1/logs",this.#i.endpoint),{headers:{"Content-Type":"application/json"},keepalive:!0,method:"POST",body:JSON.stringify({logs:a})}).catch(()=>void 0)}#h(e,t){this.isDebug&&(void 0!==console.groupCollapsed?(console.groupCollapsed("[clerk/telemetry]",e),console.log(t),console.groupEnd()):console.log("[clerk/telemetry]",e,t))}#y(){return{name:this.#o.sdk,version:this.#o.sdkVersion}}#u(e,t){let a=this.#y();return{event:e,cv:this.#o.clerkVersion??"",it:this.#o.instanceType??"",sdk:a.name,sdkv:a.version,...this.#o.publishableKey?{pk:this.#o.publishableKey}:{},...this.#o.secretKey?{sk:this.#o.secretKey}:{},payload:t}}#v(e){if(null==e||"object"!=typeof e)return null;try{let t=JSON.parse(JSON.stringify(e));if(t&&"object"==typeof t&&!Array.isArray(t))return t;return null}catch{return null}}};(0,r.withLegacyReturn)(t.verifyToken);var u=e.i(57594);let h={secretKey:u.SECRET_KEY,publishableKey:u.PUBLISHABLE_KEY,apiUrl:u.API_URL,apiVersion:u.API_VERSION,userAgent:"@clerk/nextjs@6.37.1",proxyUrl:u.PROXY_URL,domain:u.DOMAIN,isSatellite:u.IS_SATELLITE,machineSecretKey:u.MACHINE_SECRET_KEY,sdkMetadata:u.SDK_METADATA,telemetry:{disabled:u.TELEMETRY_DISABLED,debug:u.TELEMETRY_DEBUG}},p=e=>{let a,r,s,n;return a={...h,...e},r=(0,t.createBackendApiClient)(a),s=(0,t.createAuthenticateRequest)({options:a,apiClient:r}),n=new c({publishableKey:a.publishableKey,secretKey:a.secretKey,samplingRate:.1,...a.sdkMetadata?{sdk:a.sdkMetadata.name,sdkVersion:a.sdkMetadata.version}:{},...a.telemetry||{}}),{...r,...s,telemetry:n}};var g=e.i(73271);let m=new(e.i(78500)).AsyncLocalStorage;var y=e.i(13832);let v=async()=>{var e,r;let s;try{let e=await (0,a.buildRequestLike)(),r=(0,g.getHeader)(e,t.constants.Headers.ClerkRequestData);s=(0,y.decryptClerkRequestData)(r)}catch(e){if(e&&(0,a.isPrerenderingBailout)(e))throw e}let n=null!=(r=null==(e=m.getStore())?void 0:e.get("requestData"))?r:s;return(null==n?void 0:n.secretKey)||(null==n?void 0:n.publishableKey)?p(n):p({})};var f=e.i(7218);async function E(t){e.r(23502);let{userId:a}=await (0,f.auth)({treatPendingAsSignedOut:null==t?void 0:t.treatPendingAsSignedOut});return a?(await v()).users.getUser(a):null}e.s(["currentUser",()=>E],61419)},77840,e=>e.a(async(t,a)=>{try{var r=e.i(89171),s=e.i(7218),n=e.i(61419),i=e.i(15115),l=t([i]);async function o(){try{let{userId:e}=await (0,s.auth)();if(!e)return r.NextResponse.json({error:"NÃ£o autenticado"},{status:401});let t=await i.default.query("SELECT id as tenant_id, name, role, trial_status, is_admin, terms_accepted_at FROM tenants WHERE clerk_user_id = $1 LIMIT 1",[e]);if(t.rows.length>0)return r.NextResponse.json({tenantId:t.rows[0].tenant_id,name:t.rows[0].name,role:t.rows[0].role,trialStatus:t.rows[0].trial_status,isAdmin:t.rows[0].is_admin,termsAccepted:null!==t.rows[0].terms_accepted_at,userId:e});let a=await (0,n.currentUser)(),l=a?.fullName||a?.firstName||"Profissional",o=a?.emailAddresses?.[0]?.emailAddress||"",d=new Date,c=new Date(d.getTime()+2592e6),u=await i.default.query(`INSERT INTO tenants (name, email, clerk_user_id, role, trial_start, trial_end, trial_status, max_patients, max_sessions, is_admin)
       VALUES ($1, $2, $3, 'professional', $4, $5, 'trial', 5, 15, false)
       RETURNING id as tenant_id`,[l,o,e,d,c]);return r.NextResponse.json({tenantId:u.rows[0].tenant_id,name:l,role:"professional",trialStatus:"trial",isAdmin:!1,termsAccepted:!1,userId:e,isNew:!0})}catch(e){return console.error("Erro ao buscar/criar tenant:",e),r.NextResponse.json({error:"Erro interno"},{status:500})}}[i]=l.then?(await l)():l,e.s(["GET",()=>o]),a()}catch(e){a(e)}},!1),25463,e=>e.a(async(t,a)=>{try{var r=e.i(47909),s=e.i(74017),n=e.i(96250),i=e.i(59756),l=e.i(61916),o=e.i(74677),d=e.i(69741),c=e.i(16795),u=e.i(87718),h=e.i(95169),p=e.i(47587),g=e.i(66012),m=e.i(70101),y=e.i(26937),v=e.i(10372),f=e.i(93695);e.i(52474);var E=e.i(220),R=e.i(77840),b=t([R]);[R]=b.then?(await b)():b;let T=new r.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/user/tenant/route",pathname:"/api/user/tenant",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/user/tenant/route.ts",nextConfigOutput:"",userland:R}),{workAsyncStorage:_,workUnitAsyncStorage:k,serverHooks:A}=T;function S(){return(0,n.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:k})}async function w(e,t,a){T.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let r="/api/user/tenant/route";r=r.replace(/\/index$/,"")||"/";let n=await T.prepare(e,t,{srcPage:r,multiZoneDraftMode:!1});if(!n)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:R,params:b,nextConfig:S,parsedUrl:w,isDraftMode:_,prerenderManifest:k,routerServerContext:A,isOnDemandRevalidate:C,revalidateOnlyGenerated:N,resolvedPathname:x,clientReferenceManifest:I,serverActionsManifest:K}=n,O=(0,d.normalizeAppPath)(r),D=!!(k.dynamicRoutes[O]||k.routes[x]),P=async()=>((null==A?void 0:A.render404)?await A.render404(e,t,w,!1):t.end("This page could not be found"),null);if(D&&!_){let e=!!k.routes[x],t=k.dynamicRoutes[O];if(t&&!1===t.fallback&&!e){if(S.experimental.adapterPath)return await P();throw new f.NoFallbackError}}let M=null;!D||T.isDev||_||(M=x,M="/index"===M?"/":M);let U=!0===T.isDev||!D,L=D&&!U;K&&I&&(0,o.setManifestsSingleton)({page:r,clientReferenceManifest:I,serverActionsManifest:K});let H=e.method||"GET",q=(0,l.getTracer)(),j=q.getActiveScopeSpan(),B={params:b,prerenderManifest:k,renderOpts:{experimental:{authInterrupts:!!S.experimental.authInterrupts},cacheComponents:!!S.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:S.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,r,s)=>T.onRequestError(e,t,r,s,A)},sharedContext:{buildId:R}},V=new c.NodeNextRequest(e),$=new c.NodeNextResponse(t),F=u.NextRequestAdapter.fromNodeNextRequest(V,(0,u.signalFromNodeResponse)(t));try{let n=async e=>T.handle(F,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=q.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==h.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=a.get("next.route");if(s){let t=`${H} ${s}`;e.setAttributes({"next.route":s,"http.route":s,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${r}`)}),o=!!(0,i.getRequestMeta)(e,"minimalMode"),d=async i=>{var l,d;let c=async({previousCacheEntry:s})=>{try{if(!o&&C&&N&&!s)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let r=await n(i);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let d=B.renderOpts.collectedTags;if(!D)return await (0,g.sendResponse)(V,$,r,B.renderOpts.pendingWaitUntil),null;{let e=await r.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(r.headers);d&&(t[v.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=v.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,s=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=v.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:E.CachedRouteKind.APP_ROUTE,status:r.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:s}}}}catch(t){throw(null==s?void 0:s.isStale)&&await T.onRequestError(e,t,{routerKind:"App Router",routePath:r,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:C})},!1,A),t}},u=await T.handleResponse({req:e,nextConfig:S,cacheKey:M,routeKind:s.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:k,isRoutePPREnabled:!1,isOnDemandRevalidate:C,revalidateOnlyGenerated:N,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:o});if(!D)return null;if((null==u||null==(l=u.value)?void 0:l.kind)!==E.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(d=u.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",C?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),_&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let h=(0,m.fromNodeOutgoingHttpHeaders)(u.value.headers);return o&&D||h.delete(v.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||h.get("Cache-Control")||h.set("Cache-Control",(0,y.getCacheControlHeader)(u.cacheControl)),await (0,g.sendResponse)(V,$,new Response(u.value.body,{headers:h,status:u.value.status||200})),null};j?await d(j):await q.withPropagatedContext(e.headers,()=>q.trace(h.BaseServerSpan.handleRequest,{spanName:`${H} ${r}`,kind:l.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},d))}catch(t){if(t instanceof f.NoFallbackError||await T.onRequestError(e,t,{routerKind:"App Router",routePath:O,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:C})},!1,A),D)throw t;return await (0,g.sendResponse)(V,$,new Response(null,{status:500})),null}}e.s(["handler",()=>w,"patchFetch",()=>S,"routeModule",()=>T,"serverHooks",()=>A,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>k]),a()}catch(e){a(e)}},!1)];

//# sourceMappingURL=_afe291bf._.js.map