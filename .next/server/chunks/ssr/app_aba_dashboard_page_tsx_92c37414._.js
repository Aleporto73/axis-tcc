module.exports=[17194,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246);let e={critico:"#ef4444",alerta:"#f59e0b",moderado:"#3b82f6",bom:"#22c55e",excelente:"#10b981"};function f(a){return a<40?"critico":a<55?"alerta":a<70?"moderado":a<85?"bom":"excelente"}function g({data:a,width:c=600,height:d=180}){if(!a.length)return(0,b.jsx)("div",{className:"flex items-center justify-center h-32 text-xs text-slate-300",children:"Sem dados"});let g=c-35-10,h=d-10-25,i=a.map((b,c)=>({x:35+(1===a.length?g/2:c/(a.length-1)*g),y:10+h-b.cso_aba/100*h,cso:b.cso_aba,date:b.session_date})),j=i.map((a,b)=>`${0===b?"M":"L"} ${a.x} ${a.y}`).join(" "),k=j+` L ${i[i.length-1].x} ${10+h} L ${i[0].x} ${10+h} Z`,l=0;return(0,b.jsxs)("svg",{width:c,height:d,children:[[{y2:40,c:"#fef2f2"},{y2:55,c:"#fffbeb"},{y2:70,c:"#eff6ff"},{y2:85,c:"#f0fdf4"},{y2:100,c:"#ecfdf5"}].map((a,c)=>{let d=10+h-a.y2/100*h,e=(a.y2-l)/100*h;return l=a.y2,(0,b.jsx)("rect",{x:35,y:d,width:g,height:e,fill:a.c},c)}),[0,25,50,75,100].map(a=>{let c=10+h-a/100*h;return(0,b.jsxs)("g",{children:[(0,b.jsx)("line",{x1:35,y1:c,x2:35+g,y2:c,stroke:"#e2e8f0",strokeWidth:.5}),(0,b.jsx)("text",{x:30,y:c+3,textAnchor:"end",fontSize:9,fill:"#94a3b8",children:a})]},a)}),(0,b.jsx)("path",{d:k,fill:"#e07a2f",opacity:.15}),(0,b.jsx)("path",{d:j,fill:"none",stroke:"#e07a2f",strokeWidth:2}),i.map((c,d)=>(0,b.jsxs)("g",{children:[(0,b.jsx)("circle",{cx:c.x,cy:c.y,r:4,fill:"white",stroke:e[f(c.cso)],strokeWidth:2}),a.length<=10&&(0,b.jsx)("text",{x:c.x,y:10+h+15,textAnchor:"middle",fontSize:8,fill:"#94a3b8",children:new Date(c.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})})]},d))]})}function h(){var a;let[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)({total:0,completed:0,scheduled:0}),[p,q]=(0,c.useState)({total:0,active:0,mastered:0,maintained:0}),[r,s]=(0,c.useState)(!0);(0,c.useEffect)(()=>{fetch("/api/aba/learners").then(a=>a.json()).then(a=>{let b=a.learners||[];i(b),b.length>0&&k(b[0].id),s(!1)}).catch(()=>s(!1))},[]),(0,c.useEffect)(()=>{j&&Promise.all([fetch(`/api/aba/learners/${j}/cso-history`).then(a=>a.json()),fetch(`/api/aba/sessions?learner_id=${j}`).then(a=>a.json()),fetch(`/api/aba/protocols?learner_id=${j}`).then(a=>a.json())]).then(([a,b,c])=>{m(a.history||[]);let d=b.sessions||[];o({total:d.length,completed:d.filter(a=>"completed"===a.status).length,scheduled:d.filter(a=>"scheduled"===a.status).length});let e=c.protocols||[];q({total:e.length,active:e.filter(a=>"active"===a.status).length,mastered:e.filter(a=>"mastered"===a.status).length,maintained:e.filter(a=>"maintained"===a.status).length})}).catch(()=>{})},[j]);let t=l.length>0?l[l.length-1]:null,u=l.length>1?l[l.length-2]:null,v=t&&u?t.cso_aba-u.cso_aba:0;return r?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[50vh]",children:(0,b.jsx)("p",{className:"text-slate-400 text-sm animate-pulse",children:"Carregando..."})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"flex justify-center pt-5 mb-6 px-4",children:(0,b.jsxs)("nav",{className:"inline-flex items-center gap-1 bg-white border border-slate-200 rounded-full px-3 md:px-5 py-1.5 shadow-sm",children:[(0,b.jsx)(d.default,{href:"/aba",className:"px-3 py-1 text-sm font-medium text-slate-400 hover:text-slate-600",children:"Painel"}),(0,b.jsx)("span",{className:"text-slate-300 text-xs",children:"·"}),(0,b.jsx)(d.default,{href:"/aba/aprendizes",className:"px-3 py-1 text-sm font-medium text-slate-400 hover:text-slate-600",children:"Aprendizes"}),(0,b.jsx)("span",{className:"text-slate-300 text-xs",children:"·"}),(0,b.jsx)(d.default,{href:"/aba/sessoes",className:"px-3 py-1 text-sm font-medium text-slate-400 hover:text-slate-600",children:"Sessoes"}),(0,b.jsx)("span",{className:"text-slate-300 text-xs",children:"·"}),(0,b.jsx)(d.default,{href:"/aba/relatorios",className:"px-3 py-1 text-sm font-medium text-slate-400 hover:text-slate-600",children:"Relatorios"})]})}),(0,b.jsxs)("div",{className:"px-4 md:px-8 lg:px-12 xl:px-16",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-lg font-normal text-slate-400",children:"Dashboard Clinico"}),(0,b.jsx)("p",{className:"text-xs text-slate-300",children:"Progresso terapeutico"})]}),h.length>1&&(0,b.jsx)("select",{value:j,onChange:a=>k(a.target.value),className:"px-3 py-1.5 text-sm border border-slate-200 rounded-lg bg-white",children:h.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"md:col-span-2 p-5 rounded-2xl border border-slate-200 bg-white",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-sm font-medium text-slate-800",children:"Evolucao CSO-ABA"}),(0,b.jsxs)("p",{className:"text-[11px] text-slate-400",children:["Motor v2.6.1 - ",l.length," pontos"]})]}),t&&(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-2xl font-medium",style:{color:e[f(t.cso_aba)]},children:t.cso_aba}),(0,b.jsxs)("p",{className:"text-[10px]",style:{color:e[f(t.cso_aba)]},children:[(a=t.cso_aba)<40?"Critico":a<55?"Alerta":a<70?"Moderado":a<85?"Bom":"Excelente",0!==v&&(0,b.jsxs)("span",{className:v>0?"text-green-500":"text-red-500",children:[" (",v>0?"+":"",v.toFixed(1),")"]})]})]})]}),(0,b.jsx)(g,{data:l})]}),(0,b.jsxs)("div",{className:"p-4 rounded-2xl border border-slate-200 bg-white",children:[(0,b.jsx)("h3",{className:"text-xs font-medium text-slate-600 mb-3",children:"Dimensoes"}),t?(0,b.jsx)("div",{className:"space-y-2",children:[{l:"SAS",v:t.sas,d:"Aquisicao"},{l:"PIS",v:t.pis,d:"Implementacao"},{l:"BSS",v:t.bss,d:"Comportamento"},{l:"TCM",v:t.tcm,d:"Tratamento"}].map(a=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between mb-0.5",children:[(0,b.jsxs)("span",{className:"text-[11px] text-slate-500",children:[a.l," ",(0,b.jsxs)("span",{className:"text-slate-300",children:["(",a.d,")"]})]}),(0,b.jsx)("span",{className:"text-xs font-medium text-slate-700",children:a.v})]}),(0,b.jsx)("div",{className:"h-1.5 bg-slate-100 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full rounded-full",style:{width:`${a.v}%`,backgroundColor:e[f(a.v)]}})})]},a.l))}):(0,b.jsx)("p",{className:"text-xs text-slate-300",children:"Sem dados"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"p-4 rounded-xl bg-blue-50/50 border border-blue-100",children:[(0,b.jsx)("p",{className:"text-2xl font-medium text-blue-600",children:p.active}),(0,b.jsx)("p",{className:"text-[11px] text-slate-500",children:"Protocolos ativos"})]}),(0,b.jsxs)("div",{className:"p-4 rounded-xl bg-green-50/50 border border-green-100",children:[(0,b.jsx)("p",{className:"text-2xl font-medium text-green-600",children:p.mastered+p.maintained}),(0,b.jsx)("p",{className:"text-[11px] text-slate-500",children:"Dominados"})]}),(0,b.jsxs)("div",{className:"p-4 rounded-xl bg-aba-500/5 border border-aba-500/20",children:[(0,b.jsx)("p",{className:"text-2xl font-medium text-aba-500",children:n.completed}),(0,b.jsx)("p",{className:"text-[11px] text-slate-500",children:"Sessoes concluidas"})]}),(0,b.jsxs)("div",{className:"p-4 rounded-xl bg-purple-50/50 border border-purple-100",children:[(0,b.jsx)("p",{className:"text-2xl font-medium text-purple-600",children:n.scheduled}),(0,b.jsx)("p",{className:"text-[11px] text-slate-500",children:"Agendadas"})]})]}),(0,b.jsxs)("div",{className:"p-4 rounded-xl border border-slate-200 bg-white",children:[(0,b.jsx)("h3",{className:"text-xs font-medium text-slate-600 mb-3",children:"Bandas CSO-ABA"}),(0,b.jsx)("div",{className:"flex gap-3 flex-wrap",children:[{l:"Critico",r:"0-39",c:"#ef4444"},{l:"Alerta",r:"40-54",c:"#f59e0b"},{l:"Moderado",r:"55-69",c:"#3b82f6"},{l:"Bom",r:"70-84",c:"#22c55e"},{l:"Excelente",r:"85-100",c:"#10b981"}].map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a.c}}),(0,b.jsxs)("span",{className:"text-[11px] text-slate-500",children:[a.l," (",a.r,")"]})]},a.l))})]}),(0,b.jsx)("p",{className:"text-[10px] text-slate-300 text-center mt-8 mb-4",children:"AXIS ABA - Motor CSO-ABA v2.6.1"})]})]})}a.s(["default",()=>h])}];

//# sourceMappingURL=app_aba_dashboard_page_tsx_92c37414._.js.map