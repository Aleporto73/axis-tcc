module.exports=[96221,a=>{"use strict";let b=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},30491,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(23312),f=a.i(33441),g=a.i(33508),h=a.i(96221);function i(){let i=(0,d.useSearchParams)().get("token"),[j,k]=(0,c.useState)("loading"),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)("");(0,c.useEffect)(()=>{if(!i){k("error"),o("Link invalido");return}k("ready")},[i]);let p=async()=>{if(!("Notification"in window)){k("error"),o("Seu navegador não suporta notificações");return}try{k("activating");let b=await Notification.requestPermission();if("granted"!==b)return void k("denied");let c=await navigator.serviceWorker.register("/firebase-messaging-sw.js"),{initializeApp:d,getApps:e}=await a.A(10942),{getMessaging:f,getToken:g}=await a.A(49900),h=0===e().length?d({apiKey:"AIzaSyCl15IE6pCSWywO-4IiPX0QtLqy4BiXL4E",authDomain:"axis-tcc.firebaseapp.com",projectId:"axis-tcc",storageBucket:"axis-tcc.firebasestorage.app",messagingSenderId:"911481168774",appId:"1:911481168774:web:8a030d698db7046485c207"}):e()[0],j=f(h),l=await g(j,{vapidKey:"BOsFvrRAsH7tSNcG9Y4fuxsez-DveZues3qrPZjjiewrOeqiuequgrijDQsRP6ZpEOX2KCWfaynNey0yzCtjWdo",serviceWorkerRegistration:c});if(!l){k("error"),o("Não foi possível ativar notificações");return}let n=await fetch("/api/patient/push/authorize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_token:i,fcm_token:l,device_info:navigator.userAgent})}),p=await n.json();n.ok?(m(p.patient_name||""),k("success")):(k("error"),o(p.error||"Erro ao ativar"))}catch(a){console.error("Erro:",a),k("error"),o("Erro ao ativar notificações")}};return(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg max-w-md w-full p-8",children:["loading"===j&&(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)(h.Loader2,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto"})}),"ready"===j&&(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-6",children:(0,b.jsx)(e.Bell,{className:"w-10 h-10 text-blue-600"})}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 mb-3",children:"Ativar Lembretes"}),(0,b.jsx)("p",{className:"text-neutral-600 mb-6",children:"Receba lembretes das suas sessoes diretamente no seu celular ou computador."}),(0,b.jsx)("p",{className:"text-sm text-neutral-500 mb-8 bg-neutral-50 p-4 rounded-lg",children:"Você recebera apenas lembretes de horario das suas sessoes. Nenhuma informacao clínica sera enviada."}),(0,b.jsx)("button",{onClick:p,className:"w-full px-6 py-4 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-semibold text-lg transition-colors",children:"Ativar Notificações"})]}),"activating"===j&&(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(h.Loader2,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-neutral-600",children:"Ativando notificações..."})]}),"success"===j&&(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-20 h-20 rounded-full bg-emerald-100 flex items-center justify-center mx-auto mb-6",children:(0,b.jsx)(f.Check,{className:"w-10 h-10 text-emerald-600"})}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 mb-3",children:"Lembretes Ativados!"}),(0,b.jsxs)("p",{className:"text-neutral-600 mb-4",children:[l?`${l}, voc\xea`:"Você"," recebera lembretes antes das suas sessoes."]}),(0,b.jsx)("p",{className:"text-sm text-neutral-500",children:"Pode fechar esta página."})]}),"denied"===j&&(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-20 h-20 rounded-full bg-amber-100 flex items-center justify-center mx-auto mb-6",children:(0,b.jsx)(e.Bell,{className:"w-10 h-10 text-amber-600"})}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 mb-3",children:"Permissao Negada"}),(0,b.jsx)("p",{className:"text-neutral-600 mb-6",children:"Para receber lembretes, você precisa permitir notificações no seu navegador."}),(0,b.jsx)("button",{onClick:()=>k("ready"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Tentar Novamente"})]}),"error"===j&&(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-20 h-20 rounded-full bg-red-100 flex items-center justify-center mx-auto mb-6",children:(0,b.jsx)(g.X,{className:"w-10 h-10 text-red-600"})}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 mb-3",children:"Erro"}),(0,b.jsx)("p",{className:"text-neutral-600",children:n||"Não foi possível ativar os lembretes."})]}),(0,b.jsx)("div",{className:"mt-8 pt-6 border-t border-neutral-100 text-center",children:(0,b.jsx)("p",{className:"text-xs text-neutral-400",children:"AXIS TCC - Sistema de Apoio Clínico"})})]})}function j(){return(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-white flex items-center justify-center p-4",children:(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)(h.Loader2,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto"})}),children:(0,b.jsx)(i,{})})})}a.s(["default",()=>j])}];

//# sourceMappingURL=_8968624c._.js.map