module.exports=[84334,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(29662),e=a.i(50944),f=a.i(38246),g=a.i(14942),h=a.i(24669),i=a.i(53277),j=a.i(23025),k=a.i(41710),l=a.i(50429),m=a.i(90669),n=a.i(33508),o=a.i(73570),p=a.i(41675),q=a.i(63588);let r=(0,a.i(70106).default)("file-down",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);var s=a.i(33441);let t={auto:{border:"#e2e8f0",bg:"#f8fafc",label:"Cálculo automático",dot:"#cbd5e1"},professional:{border:"#bbf7d0",bg:"#f0fdf4",label:"Registro do Profissional",dot:"#86efac"},attention:{border:"#fde68a",bg:"#fffbeb",label:"Atenção",dot:"#fcd34d"}};function u({type:a,children:c,className:d=""}){let e=t[a];return(0,b.jsx)("div",{className:`rounded-xl overflow-hidden ${d}`,style:{border:`1px solid ${"attention"===a?"#fde68a":"#e5e7eb"}`},children:(0,b.jsxs)("div",{style:{display:"flex"},children:[(0,b.jsx)("div",{style:{width:"3px",flexShrink:0,backgroundColor:e.border,borderRadius:"3px 0 0 3px"}}),(0,b.jsx)("div",{style:{flex:1},children:c})]})})}function v({type:a}){let c=t[a];return(0,b.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("span",{style:{width:6,height:6,borderRadius:"50%",backgroundColor:c.dot,display:"inline-block"}}),(0,b.jsx)("span",{className:"text-xs text-gray-400",children:c.label})]})}function w({patientId:a,patientName:d,sessionsCount:e,onClose:f}){let g,w,x,[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1);(0,c.useEffect)(()=>{M()},[]);let M=async()=>{try{B(!0);let[b,c]=await Promise.all([fetch(`/api/patients/${a}/evolution`),fetch(`/api/patients/${a}/supervision`)]);if(b.ok){let c=await b.json();z(c),fetch("/api/audit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"REPORT_VIEW",entity_type:"report",entity_id:a,metadata:{report_type:"longitudinal",sessions_count:c.total_sessions}})})}else D("Erro ao carregar dados");if(c.ok){let a=await c.json();a.context&&(H(a.context),F(!0))}}catch(a){D("Erro ao carregar dados")}finally{B(!1)}},N=(0,c.useCallback)(async()=>{if(!I){J(!0),L(!1);try{(await fetch(`/api/patients/${a}/supervision`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({context:G})})).ok&&(L(!0),setTimeout(()=>L(!1),2e3))}catch(a){console.error("Erro ao salvar:",a)}finally{J(!1)}}},[a,G,I]);if(A)return(0,b.jsx)("div",{className:"bg-white rounded-2xl p-8 border border-gray-200 mt-6 shadow-sm",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-6 bg-gray-100 rounded w-1/3"}),(0,b.jsx)("div",{className:"h-32 bg-gray-50 rounded"})]})});if(C||!y)return(0,b.jsx)("div",{className:"bg-white rounded-2xl p-6 border border-gray-200 mt-6",children:(0,b.jsx)("p",{className:"text-gray-500",children:C||"Erro ao carregar dados"})});let O=Math.max(y.event_percentages.EVITOU,y.event_percentages.ENFRENTOU,y.event_percentages.AJUSTOU,y.event_percentages.RECUPEROU,1),P=[{label:"Evitou",value:y.event_percentages.EVITOU,angle:-90,color:"#d97706"},{label:"Enfrentou",value:y.event_percentages.ENFRENTOU,angle:0,color:"#059669"},{label:"Recuperou",value:y.event_percentages.RECUPEROU,angle:90,color:"#7c3aed"},{label:"Ajustou",value:y.event_percentages.AJUSTOU,angle:180,color:"#0891b2"}],Q=(a,b)=>{let c=a/100*60,d=b*Math.PI/180;return{x:90+c*Math.cos(d),y:90+c*Math.sin(d)}},R=P.map((a,b)=>{let c=Q(a.value,a.angle);return`${0===b?"M":"L"} ${c.x} ${c.y}`}).join(" ")+" Z";return(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-200 mt-6 overflow-hidden shadow-sm",children:[(0,b.jsx)("div",{className:"px-6 py-5 border-b border-gray-100",style:{backgroundColor:"#f0fdf4"},children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"font-serif text-2xl",style:{color:"#166534"},children:"Evolução do Processo"}),(0,b.jsxs)("p",{className:"text-sm mt-1",style:{color:"#15803d"},children:["Relatório longitudinal • ",y.total_sessions," sessões analisadas"]})]}),(0,b.jsx)("button",{onClick:f,className:"p-2 hover:bg-green-100 rounded-lg transition-colors",children:(0,b.jsx)(n.X,{className:"w-5 h-5",style:{color:"#16a34a"}})})]})}),(0,b.jsx)("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-100",children:(0,b.jsx)("p",{className:"text-xs text-gray-600",children:"Este relatório descreve padrões observáveis ao longo do tempo. Não contém inferência diagnóstica, interpretação psicológica ou juízo clínico."})}),(0,b.jsxs)("div",{className:"px-6 py-2.5 border-b border-gray-100 flex items-center gap-5",children:[(0,b.jsx)("span",{className:"text-xs text-gray-400 uppercase tracking-wide",style:{fontSize:"10px"},children:"Autoria:"}),Object.entries(t).map(([a,c])=>(0,b.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("span",{style:{width:6,height:6,borderRadius:"50%",backgroundColor:c.dot,display:"inline-block"}}),(0,b.jsx)("span",{className:"text-xs text-gray-400",children:c.label})]},a))]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsx)(u,{type:"auto",children:(0,b.jsxs)("div",{className:"p-5",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide",children:"Indicadores"}),(0,b.jsx)(v,{type:"auto"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,b.jsx)(l.Target,{className:"w-4 h-4 text-gray-400"}),(0,b.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Sessões"})]}),(0,b.jsx)("p",{className:"text-3xl font-light text-gray-900",children:y.total_sessions}),(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"finalizadas"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,b.jsx)(m.Activity,{className:"w-4 h-4 text-gray-400"}),(0,b.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Eventos"})]}),(0,b.jsx)("p",{className:"text-3xl font-light text-gray-900",children:y.total_events}),(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"registrados"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,b.jsx)(k.Clock,{className:"w-4 h-4 text-gray-400"}),(0,b.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Recuperação"})]}),(0,b.jsx)("p",{className:"text-3xl font-light text-gray-900",children:y.avg_recovery_time||"-"}),(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"min (média)"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:["up"===y.trend?(0,b.jsx)(h.TrendingUp,{className:"w-4 h-4 text-gray-400"}):"down"===y.trend?(0,b.jsx)(i.TrendingDown,{className:"w-4 h-4 text-gray-400"}):(0,b.jsx)(j.Minus,{className:"w-4 h-4 text-gray-400"}),(0,b.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Tendência"})]}),(0,b.jsx)("p",{className:"text-xl font-medium text-gray-900",children:"up"===y.trend?"Positiva":"down"===y.trend?"Observada":"Estável"}),(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"últimas sessões"})]})]})]})}),(0,b.jsx)(u,{type:"auto",children:(0,b.jsxs)("div",{className:"p-5",style:{backgroundColor:"#f8fafc"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide",children:"Tendência de Processo"}),(0,b.jsx)(v,{type:"auto"})]}),(0,b.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:(y.trend,g=Object.entries(y.event_counts).sort((a,b)=>b[1]-a[1]),y.total_events<3?"Dados insuficientes para caracterização de tendência no período analisado.":`Ao longo das sess\xf5es analisadas, a distribui\xe7\xe3o dos micro-eventos manteve configura\xe7\xe3o semelhante, com predomin\xe2ncia relativa de ${({EVITOU:"Evitação",ENFRENTOU:"Enfrentamento",AJUSTOU:"Ajuste",RECUPEROU:"Recuperação"})[g[0][0]]}. N\xe3o foram identificadas varia\xe7\xf5es progressivas sustentadas no perfil de eventos no per\xedodo.`)})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[y.total_events>=2&&(0,b.jsx)(u,{type:"auto",children:(0,b.jsxs)("div",{className:"p-5",style:{backgroundColor:"#f8fafc"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide",children:"Perfil de Distribuição"}),(0,b.jsx)(v,{type:"auto"})]}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsxs)("svg",{width:180,height:180,className:"overflow-visible",children:[[25,50,75,100].map(a=>(0,b.jsx)("circle",{cx:90,cy:90,r:a/100*60,fill:"none",stroke:"#e5e7eb",strokeWidth:"1"},a)),P.map((a,c)=>{let d=Q(100,a.angle);return(0,b.jsx)("line",{x1:90,y1:90,x2:d.x,y2:d.y,stroke:"#e5e7eb",strokeWidth:"1"},c)}),(0,b.jsx)("path",{d:R,fill:"rgba(107, 114, 128, 0.1)",stroke:"#6b7280",strokeWidth:"1.5"}),P.map((a,c)=>{let d=Q(a.value,a.angle);return(0,b.jsx)("circle",{cx:d.x,cy:d.y,r:"4",fill:a.color},c)}),P.map((a,c)=>{let d=Q(120,a.angle);return(0,b.jsx)("text",{x:d.x,y:d.y,textAnchor:"middle",dominantBaseline:"middle",className:"text-xs fill-gray-500",children:a.label},c)})]})})]})}),(0,b.jsx)(u,{type:"auto",children:(0,b.jsxs)("div",{className:"p-5",style:{backgroundColor:"#f8fafc"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide",children:"Distribuição de Eventos"}),(0,b.jsx)(v,{type:"auto"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Evitou"}),(0,b.jsxs)("span",{className:"text-gray-500",children:[y.event_counts.EVITOU," (",y.event_percentages.EVITOU,"%)"]})]}),(0,b.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full rounded-full",style:{width:`${y.event_percentages.EVITOU/O*100}%`,backgroundColor:"#d97706"}})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Enfrentou"}),(0,b.jsxs)("span",{className:"text-gray-500",children:[y.event_counts.ENFRENTOU," (",y.event_percentages.ENFRENTOU,"%)"]})]}),(0,b.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full rounded-full",style:{width:`${y.event_percentages.ENFRENTOU/O*100}%`,backgroundColor:"#059669"}})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Ajustou"}),(0,b.jsxs)("span",{className:"text-gray-500",children:[y.event_counts.AJUSTOU," (",y.event_percentages.AJUSTOU,"%)"]})]}),(0,b.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full rounded-full",style:{width:`${y.event_percentages.AJUSTOU/O*100}%`,backgroundColor:"#0891b2"}})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Recuperou"}),(0,b.jsxs)("span",{className:"text-gray-500",children:[y.event_counts.RECUPEROU," (",y.event_percentages.RECUPEROU,"%)"]})]}),(0,b.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full rounded-full",style:{width:`${y.event_percentages.RECUPEROU/O*100}%`,backgroundColor:"#7c3aed"}})})]})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:(w=Object.entries(y.event_counts).sort((a,b)=>b[1]-a[1]),x={EVITOU:"Evitação",ENFRENTOU:"Enfrentamento",AJUSTOU:"Ajuste",RECUPEROU:"Recuperação"},`Maior frequ\xeancia de ${x[w[0][0]]} (${y.event_percentages[w[0][0]]}%), seguido por ${x[w[1][0]]} (${y.event_percentages[w[1][0]]}%).`)})]})})]}),y.sessions_early&&y.sessions_recent&&y.total_sessions>=4&&(0,b.jsx)(u,{type:"auto",children:(0,b.jsxs)("div",{className:"p-5",style:{backgroundColor:"#f8fafc"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide",children:"Comparativo Temporal"}),(0,b.jsx)(v,{type:"auto"})]}),(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,b.jsx)("th",{className:"text-left py-2 text-gray-500 font-medium",children:"Período"}),(0,b.jsx)("th",{className:"text-center py-2 text-gray-500 font-medium",children:"Sessões"}),(0,b.jsx)("th",{className:"text-center py-2 text-gray-500 font-medium",children:"Eventos"}),(0,b.jsx)("th",{className:"text-center py-2 text-gray-500 font-medium",children:"Recuperação"})]})}),(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,b.jsx)("td",{className:"py-3 text-gray-700",children:"Sessões iniciais"}),(0,b.jsx)("td",{className:"py-3 text-center text-gray-600",children:y.sessions_early.count}),(0,b.jsx)("td",{className:"py-3 text-center text-gray-600",children:y.sessions_early.events}),(0,b.jsxs)("td",{className:"py-3 text-center text-gray-600",children:[y.sessions_early.avg_recovery," min"]})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"py-3 text-gray-700",children:"Sessões recentes"}),(0,b.jsx)("td",{className:"py-3 text-center text-gray-600",children:y.sessions_recent.count}),(0,b.jsx)("td",{className:"py-3 text-center text-gray-600",children:y.sessions_recent.events}),(0,b.jsxs)("td",{className:"py-3 text-center text-gray-600",children:[y.sessions_recent.avg_recovery," min"]})]})]})]})]})}),y.outlier_sessions&&y.outlier_sessions.length>0&&(0,b.jsx)(u,{type:"attention",children:(0,b.jsxs)("div",{className:"p-5",style:{backgroundColor:"#fffbeb"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("h3",{className:"text-sm font-medium uppercase tracking-wide flex items-center gap-2",style:{color:"#92400e"},children:[(0,b.jsx)(o.AlertTriangle,{className:"w-4 h-4"}),"Sessões com Variação"]}),(0,b.jsx)(v,{type:"attention"})]}),(0,b.jsx)("ul",{className:"space-y-1",children:y.outlier_sessions.map((a,c)=>(0,b.jsxs)("li",{className:"text-sm",style:{color:"#92400e"},children:[(0,b.jsxs)("span",{className:"font-medium",children:["Sessão #",a.session_number]})," — ",a.reason]},c))})]})}),(0,b.jsx)(u,{type:"auto",children:(0,b.jsxs)("div",{className:"p-5",style:{backgroundColor:"#f8fafc"},children:[(0,b.jsxs)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide mb-4 flex items-center gap-2",children:[(0,b.jsx)(p.Calendar,{className:"w-4 h-4 text-gray-400"}),"Linha do Tempo"]}),0===y.timeline.length?(0,b.jsx)("p",{className:"text-gray-500 text-sm",children:"Nenhuma sessão finalizada"}):(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute left-3 top-0 bottom-0 w-px bg-gray-300"}),(0,b.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:y.timeline.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-3 relative pl-8",children:[(0,b.jsx)("div",{className:"absolute left-0 w-6 h-6 bg-white border-2 border-gray-300 rounded-full flex items-center justify-center text-xs text-gray-600 font-medium",children:a.session_number}),(0,b.jsxs)("div",{className:"flex-1 bg-white rounded-lg p-2 border border-gray-200",children:[(0,b.jsx)("span",{className:"text-sm text-gray-700",children:new Date(a.date).toLocaleDateString("pt-BR")}),(0,b.jsx)("span",{className:"text-xs text-gray-400 ml-2",children:a.duration?`${a.duration} min`:""})]})]},c))})]})]})}),(0,b.jsx)(u,{type:"professional",children:(0,b.jsxs)("div",{className:"p-5 bg-white",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide flex items-center gap-2",children:[(0,b.jsx)(q.MessageSquare,{className:"w-4 h-4 text-gray-400"}),"Contexto para supervisão"]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(v,{type:"professional"}),(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:E,onChange:a=>F(a.target.checked),className:"w-4 h-4 text-green-600 rounded border-gray-300"}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"Incluir"})]})]})]}),E&&(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("textarea",{value:G,onChange:a=>H(a.target.value.slice(0,800)),placeholder:"Informações clínicas relevantes para supervisão...",className:"w-full h-24 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 resize-none"}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("span",{className:"text-xs text-gray-400",children:[G.length,"/800"]}),(0,b.jsx)("button",{onClick:N,disabled:I,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all",style:{backgroundColor:K?"#f0fdf4":"#f8fafc",color:K?"#16a34a":"#64748b",border:`1px solid ${K?"#bbf7d0":"#e2e8f0"}`},children:I?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Salvando..."]}):K?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Check,{className:"w-3 h-3"}),"Salvo"]}):"Salvar contexto"})]})]})]})}),(0,b.jsx)("div",{className:"flex justify-center pt-2",children:(0,b.jsxs)("button",{onClick:()=>{fetch("/api/audit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"REPORT_EXPORT",entity_type:"report",entity_id:a,metadata:{format:"pdf",sessions_count:y?.total_sessions}})}),window.open(`/relatorio/${a}`,"_blank")},className:"flex items-center gap-2 px-6 py-3 text-white rounded-xl text-sm font-medium transition-all hover:opacity-90",style:{backgroundColor:"#16a34a"},children:[(0,b.jsx)(r,{className:"w-4 h-4"}),"Exportar PDF"]})})]}),(0,b.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100",children:(0,b.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"Este relatório não substitui avaliação clínica profissional. Interpretação exclusiva do profissional responsável."})})]})}function x(){let a=(0,e.useRouter)(),h=(0,e.useParams)().id,{isLoaded:i,userId:j}=(0,d.useAuth)(),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)({}),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)("record"),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(null),[X,Y]=(0,c.useState)(!1),[Z,$]=(0,c.useState)(!1),[_,aa]=(0,c.useState)({complaint:"",patterns:"",interventions:"",current_state:"",transcript:""}),[ab,ac]=(0,c.useState)(!1),ad=(0,c.useRef)(null),ae=(0,c.useRef)([]),af=(0,c.useRef)(null);(0,c.useEffect)(()=>{i&&j&&h&&(ag(),ah())},[i,j,h]);let ag=async()=>{try{p(!0);let[a,b]=await Promise.all([fetch(`/api/patients/${h}`),fetch(`/api/patients/${h}/sessions`)]);if(a.ok){let b=await a.json();l(b.patient)}if(b.ok){let a=await b.json();n(a.sessions||[])}}catch(a){console.error("Erro:",a)}finally{p(!1)}},ah=async()=>{try{let a=await fetch(`/api/patients/${h}/clinical-record`);if(a.ok){let b=await a.json();O(b.exists),b.exists&&M(b.record)}}catch(a){console.error("Erro ao carregar registro clínico:",a)}},ai=async()=>{v(!0);try{(await fetch(`/api/patients/${h}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).ok&&(r(!1),ag())}catch(a){console.error("Erro:",a)}finally{v(!1)}},aj=async()=>{y(!0);try{(await fetch(`/api/patients/${h}`,{method:"DELETE"})).ok&&a.push("/pacientes")}catch(a){console.error("Erro:",a)}finally{y(!1)}},ak=async()=>{G(!0);try{let a=await fetch(`/api/patients/${h}/push-link`,{method:"POST"});if(a.ok){let b=await a.json();E(b.link),C(!0)}}catch(a){console.error("Erro:",a)}finally{G(!1)}},al=async()=>{try{let a=await navigator.mediaDevices.getUserMedia({audio:!0}),b=new MediaRecorder(a);ad.current=b,ae.current=[],b.ondataavailable=a=>ae.current.push(a.data),b.onstop=()=>{let b=new Blob(ae.current,{type:"audio/webm"});W(b),a.getTracks().forEach(a=>a.stop())},b.start(),U(!0)}catch(a){console.error("Erro ao iniciar gravação:",a),alert("Não foi possível acessar o microfone")}},am=async()=>{if(V){Y(!0);try{let a=new FormData;a.append("audio",V,"clinical_record.webm");let b=await fetch("/api/transcribe-audio",{method:"POST",body:a});if(!b.ok)throw Error("Erro na transcrição");let c=(await b.json()).text;aa(a=>({...a,transcript:c})),Y(!1),$(!0);let d=await fetch("/api/analyze-clinical",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:c,patientName:k?.full_name})});if(d.ok){let a=await d.json();aa({complaint:a.complaint||"",patterns:a.patterns||"",interventions:a.interventions||"",current_state:a.current_state||"",transcript:c})}S("review")}catch(a){console.error("Erro ao processar áudio:",a),alert("Erro ao processar áudio")}finally{Y(!1),$(!1)}}},an=async()=>{ac(!0);try{(await fetch(`/api/patients/${h}/clinical-record`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:_.complaint,patterns:_.patterns,interventions:_.interventions,current_state:_.current_state,original_transcript:_.transcript})})).ok&&(Q(!1),S("record"),W(null),aa({complaint:"",patterns:"",interventions:"",current_state:"",transcript:""}),ah())}catch(a){console.error("Erro ao salvar:",a)}finally{ac(!1)}};return!i||o?(0,b.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,b.jsx)(g.default,{}),(0,b.jsx)("main",{className:"md:ml-20 min-h-screen flex items-center justify-center",children:(0,b.jsx)("div",{className:"w-6 h-6 border-2 border-sky-500 border-t-transparent rounded-full animate-spin"})})]}):k?(0,b.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,b.jsx)(g.default,{}),(0,b.jsx)("main",{className:"md:ml-20 min-h-screen pb-20 md:pb-8",children:(0,b.jsx)("div",{className:"px-4 md:px-8 lg:px-12 xl:px-16 pt-6",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)(f.default,{href:"/pacientes",className:"inline-flex items-center gap-2 text-slate-500 hover:text-sky-600 transition-colors mb-6 text-sm",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Voltar"]}),(0,b.jsxs)("header",{className:"flex items-start justify-between mb-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"font-serif text-3xl md:text-4xl font-light text-slate-900 tracking-tight mb-1",children:k.name||k.full_name}),(0,b.jsx)("p",{className:"text-base text-slate-400 italic font-light",children:"Informações e histórico do paciente"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[m.filter(a=>"finalizada"===a.status).length>=3&&(0,b.jsxs)("button",{onClick:()=>K(!J),className:"flex items-center gap-2 px-4 py-2 bg-emerald-50 text-emerald-600 border border-emerald-300 rounded-lg hover:bg-emerald-100 transition-colors text-sm font-medium",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Evolução"]}),(0,b.jsxs)("button",{onClick:ak,disabled:F,className:"flex items-center gap-2 px-4 py-2 bg-amber-50 text-amber-600 border border-amber-300 rounded-lg hover:bg-amber-100 transition-colors text-sm font-medium disabled:opacity-50",children:[F?(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-amber-500 border-t-transparent rounded-full animate-spin"}):(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),"Lembretes"]}),(0,b.jsxs)("button",{onClick:()=>{A({name:k?.full_name||"",email:k?.email||"",phone:k?.phone||"",birth_date:k?.birth_date?k.birth_date.split("T")[0]:"",gender:k?.gender||"",diagnosis:k?.diagnosis||"",medication:k?.medication||"",notes:k?.notes||""}),r(!0)},className:"flex items-center gap-2 px-4 py-2 bg-sky-50 text-sky-600 border border-sky-300 rounded-lg hover:bg-sky-100 transition-colors text-sm font-medium",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Editar"]}),(0,b.jsxs)("button",{onClick:()=>t(!0),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-600 border border-slate-300 rounded-lg hover:bg-slate-200 transition-colors text-sm font-medium",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Excluir"]})]})]}),(0,b.jsxs)("section",{className:"grid grid-cols-3 gap-4 mb-6 pb-6 border-b border-slate-100",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-xs text-slate-400 uppercase tracking-wider mb-1",children:"Email"}),(0,b.jsx)("p",{className:"text-slate-900 text-sm",children:k.email||"-"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-xs text-slate-400 uppercase tracking-wider mb-1",children:"Telefone"}),(0,b.jsx)("p",{className:"text-slate-900 text-sm",children:(a=>{if(!a)return"-";let b=a.replace(/\D/g,"");return 11===b.length?`(${b.slice(0,2)}) ${b.slice(2,7)}-${b.slice(7)}`:10===b.length?`(${b.slice(0,2)}) ${b.slice(2,6)}-${b.slice(6)}`:a})(k.phone)})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-xs text-slate-400 uppercase tracking-wider mb-1",children:"Data de Nascimento"}),(0,b.jsx)("p",{className:"text-slate-900 text-sm",children:k.birth_date?new Date(k.birth_date).toLocaleDateString("pt-BR"):"-"})]})]}),!N&&(0,b.jsx)("section",{className:"bg-sky-50 border border-sky-200 rounded-lg p-4 mb-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("svg",{className:"w-5 h-5 text-sky-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium text-sky-900 text-sm",children:"Registro Clínico Assistido"}),(0,b.jsx)("p",{className:"text-xs text-sky-700",children:"Para pacientes com histórico terapêutico anterior ao uso do AXIS"})]})]}),(0,b.jsx)("button",{onClick:()=>Q(!0),className:"px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 text-sm font-medium transition-colors",children:"Registrar histórico"})]})}),N&&L&&(0,b.jsxs)("section",{className:"bg-slate-50 border border-slate-200 rounded-lg p-5 mb-6",children:[(0,b.jsx)("h3",{className:"font-medium text-slate-800 mb-1 text-sm",children:"Contexto Clínico Inicial"}),(0,b.jsx)("p",{className:"text-xs text-slate-400 mb-4",children:"Registro retrospectivo informado pelo profissional antes do início das sessões no sistema."}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[L.complaint&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:"Evento ou contexto inicial"}),(0,b.jsx)("p",{className:"text-sm text-slate-800",children:L.complaint})]}),L.patterns&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:"Aspectos mencionados no histórico"}),(0,b.jsx)("p",{className:"text-sm text-slate-800",children:L.patterns})]}),L.interventions&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:"Intervenções prévias relatadas"}),(0,b.jsx)("p",{className:"text-sm text-slate-800",children:L.interventions})]}),L.current_state&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:"Situação atual conforme relato"}),(0,b.jsx)("p",{className:"text-sm text-slate-800",children:L.current_state})]})]})]}),(k.diagnosis||k.medication||k.notes||k.gender)&&(0,b.jsxs)("section",{className:"mb-6 pb-6 border-b border-slate-100",children:[(0,b.jsx)("h2",{className:"font-serif text-xl font-light text-slate-800 mb-4",children:"Informações Clínicas"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[k.gender&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-slate-400 mb-1",children:"Gênero"}),(0,b.jsx)("p",{className:"text-sm text-slate-800",children:k.gender})]}),k.diagnosis&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-slate-400 mb-1",children:"Diagnóstico"}),(0,b.jsx)("p",{className:"text-sm text-slate-800",children:k.diagnosis})]}),k.medication&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-slate-400 mb-1",children:"Medicação"}),(0,b.jsx)("p",{className:"text-sm text-slate-800",children:k.medication})]}),k.notes&&(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("p",{className:"text-xs text-slate-400 mb-1",children:"Observações"}),(0,b.jsx)("p",{className:"text-sm text-slate-800",children:k.notes})]})]})]}),J&&(0,b.jsx)("div",{id:"evolution-report",children:(0,b.jsx)(w,{patientId:h,sessionsCount:m.filter(a=>"finalizada"===a.status).length,onClose:()=>K(!1)})}),(0,b.jsxs)("section",{children:[(0,b.jsxs)("h2",{className:"font-serif text-xl font-light text-slate-800 mb-4",children:["Histórico de Sessões (",m.length,")"]}),0===m.length?(0,b.jsx)("p",{className:"text-slate-400 italic text-sm",children:"Nenhuma sessão registrada"}):(0,b.jsxs)("div",{className:"w-full overflow-x-auto",children:[(0,b.jsxs)("div",{className:"hidden md:grid grid-cols-12 gap-4 pb-3 border-b border-slate-200 text-xs uppercase tracking-wider text-slate-400 font-medium",children:[(0,b.jsx)("div",{className:"col-span-1",children:"#"}),(0,b.jsx)("div",{className:"col-span-3",children:"Data"}),(0,b.jsx)("div",{className:"col-span-4",children:"Status"}),(0,b.jsx)("div",{className:"col-span-4",children:"Duração"})]}),(0,b.jsx)("div",{className:"flex flex-col",children:m.map(c=>(0,b.jsxs)("div",{onClick:()=>a.push(`/sessoes/${c.id}`),className:"grid grid-cols-12 gap-4 py-3 items-center hover:bg-slate-50/50 transition-colors cursor-pointer border-b border-slate-100",children:[(0,b.jsx)("div",{className:"col-span-1 text-sm text-slate-600",children:c.session_number}),(0,b.jsx)("div",{className:"col-span-3 text-sm text-slate-700",children:new Date(c.scheduled_at||c.started_at||c.created_at).toLocaleDateString("pt-BR")}),(0,b.jsx)("div",{className:"col-span-4",children:(0,b.jsx)("span",{className:`text-sm ${(a=>{switch(a){case"em_andamento":return"text-sky-600";case"agendada":return"text-amber-600";default:return"text-slate-500"}})(c.status)}`,children:(a=>{switch(a){case"em_andamento":return"Em andamento";case"agendada":return"Agendada";case"finalizada":return"Finalizada";default:return a}})(c.status)})}),(0,b.jsx)("div",{className:"col-span-4 text-sm text-slate-500",children:c.duration_minutes?`${c.duration_minutes} min`:"-"})]},c.id))})]})]})]})})}),B&&(0,b.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-100",children:[(0,b.jsx)("h3",{className:"font-serif text-xl font-light text-slate-900",children:"Link de Lembretes"}),(0,b.jsx)("button",{onClick:()=>C(!1),className:"text-slate-400 hover:text-slate-600",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Envie este link para o paciente ativar lembretes no celular:"}),(0,b.jsx)("div",{className:"bg-slate-100 p-3 rounded-lg mb-4 break-all text-sm font-mono text-slate-700",children:D}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(D),I(!0),setTimeout(()=>I(!1),2e3)},className:"flex-1 px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 text-sm font-medium",children:H?"Copiado!":"Copiar Link"}),(0,b.jsx)("a",{href:`https://wa.me/?text=${encodeURIComponent("Olá! Ative seus lembretes de sessão: "+D)}`,target:"_blank",className:"flex-1 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 text-sm font-medium text-center",children:"Enviar WhatsApp"})]}),(0,b.jsx)("p",{className:"text-xs text-slate-400 mt-3",children:"O paciente só receberá lembretes logísticos (data/hora). Nenhuma informação clínica será enviada."})]})]})}),q&&(0,b.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-100",children:[(0,b.jsx)("h3",{className:"font-serif text-xl font-light text-slate-900",children:"Editar Paciente"}),(0,b.jsx)("button",{onClick:()=>r(!1),className:"text-slate-400 hover:text-slate-600",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nome"}),(0,b.jsx)("input",{type:"text",value:z.name,onChange:a=>A({...z,name:a.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email"}),(0,b.jsx)("input",{type:"email",value:z.email,onChange:a=>A({...z,email:a.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Telefone"}),(0,b.jsx)("input",{type:"tel",value:z.phone,onChange:a=>A({...z,phone:a.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Data de Nascimento"}),(0,b.jsx)("input",{type:"date",value:z.birth_date,onChange:a=>A({...z,birth_date:a.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Gênero"}),(0,b.jsx)("input",{type:"text",value:z.gender,onChange:a=>A({...z,gender:a.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Diagnóstico"}),(0,b.jsx)("input",{type:"text",value:z.diagnosis,onChange:a=>A({...z,diagnosis:a.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Medicação"}),(0,b.jsx)("input",{type:"text",value:z.medication,onChange:a=>A({...z,medication:a.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Observações"}),(0,b.jsx)("textarea",{value:z.notes,onChange:a=>A({...z,notes:a.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm resize-none"})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 p-6 border-t border-slate-100 bg-slate-50 rounded-b-xl",children:[(0,b.jsx)("button",{onClick:()=>r(!1),className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg hover:bg-slate-100 text-sm text-slate-600",children:"Cancelar"}),(0,b.jsx)("button",{onClick:ai,disabled:u,className:"flex-1 px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 disabled:opacity-50 text-sm font-medium",children:u?"Salvando...":"Salvar"})]})]})}),s&&(0,b.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 p-4",children:(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-xl max-w-sm w-full",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("h3",{className:"font-serif text-xl font-light text-slate-900 mb-2",children:"Excluir Paciente"}),(0,b.jsxs)("p",{className:"text-slate-600 text-sm mb-6",children:["Tem certeza que deseja excluir ",(0,b.jsx)("strong",{children:k.full_name}),"? Esta ação não pode ser desfeita."]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:()=>t(!1),className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg hover:bg-slate-100 text-sm text-slate-600",children:"Cancelar"}),(0,b.jsx)("button",{onClick:aj,disabled:x,className:"flex-1 px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 disabled:opacity-50 text-sm font-medium",children:x?"Excluindo...":"Excluir"})]})]})})}),P&&(0,b.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-xl w-full max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-100",children:[(0,b.jsx)("h3",{className:"font-serif text-xl font-light text-slate-900",children:"Registro Clínico Assistido"}),(0,b.jsx)("button",{onClick:()=>{Q(!1),S("record"),W(null)},className:"text-slate-400 hover:text-slate-600",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),"record"===R&&(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("p",{className:"text-sm text-slate-600 mb-2",children:"Grave ou importe um resumo clínico inicial com base no seu conhecimento prévio do paciente."}),(0,b.jsx)("p",{className:"text-xs text-slate-400 mb-6",children:"Inclua contexto inicial, intervenções prévias e situação atual."}),(0,b.jsx)("input",{type:"file",ref:af,accept:"audio/*",onChange:a=>{let b=a.target.files?.[0];b&&W(b)},className:"hidden"}),(0,b.jsx)("div",{className:"flex flex-col items-center gap-4",children:V?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-emerald-600",children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,b.jsx)("span",{className:"text-sm",children:"Áudio pronto"})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:()=>W(null),className:"px-4 py-2 border border-slate-200 rounded-lg hover:bg-slate-50 text-sm text-slate-600",children:"Escolher outro"}),(0,b.jsxs)("button",{onClick:am,disabled:X||Z,className:"px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 disabled:opacity-50 text-sm font-medium flex items-center gap-2",children:[(X||Z)&&(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),X?"Transcrevendo...":Z?"Analisando...":"Processar"]})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[T?(0,b.jsx)("button",{onClick:()=>{ad.current&&T&&(ad.current.stop(),U(!1))},className:"w-20 h-20 rounded-full bg-rose-600 animate-pulse flex items-center justify-center text-white",children:(0,b.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("rect",{x:"6",y:"6",width:"12",height:"12"})})}):(0,b.jsx)("button",{onClick:al,className:"w-20 h-20 rounded-full bg-rose-500 hover:bg-rose-600 flex items-center justify-center text-white transition-colors",children:(0,b.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),(0,b.jsx)("button",{onClick:()=>af.current?.click(),className:"w-14 h-14 rounded-full bg-slate-200 hover:bg-slate-300 flex items-center justify-center text-slate-600 transition-colors",title:"Importar áudio",children:(0,b.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})})]}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:T?"Gravando... Clique para parar":"Grave ou importe um áudio"})]})})]}),"review"===R&&(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Resumo clínico preliminar gerado. Revise e edite se necessário."}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Evento ou contexto inicial"}),(0,b.jsx)("textarea",{value:_.complaint,onChange:a=>aa({..._,complaint:a.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm resize-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Aspectos mencionados no histórico"}),(0,b.jsx)("textarea",{value:_.patterns,onChange:a=>aa({..._,patterns:a.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm resize-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Intervenções prévias relatadas"}),(0,b.jsx)("textarea",{value:_.interventions,onChange:a=>aa({..._,interventions:a.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm resize-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Situação atual conforme relato"}),(0,b.jsx)("textarea",{value:_.current_state,onChange:a=>aa({..._,current_state:a.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm resize-none"})]})]}),(0,b.jsx)("p",{className:"text-xs text-slate-400 mt-4 italic",children:"Este registro é descritivo, retrospectivo e não substitui sessões clínicas."}),(0,b.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,b.jsx)("button",{onClick:()=>{S("record"),W(null)},className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg hover:bg-slate-50 text-sm text-slate-600",children:"Voltar"}),(0,b.jsx)("button",{onClick:an,disabled:ab,className:"flex-1 px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 disabled:opacity-50 text-sm font-medium",children:ab?"Salvando...":"Confirmar e salvar"})]})]})]})})]}):(0,b.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,b.jsx)(g.default,{}),(0,b.jsx)("main",{className:"md:ml-20 min-h-screen flex items-center justify-center",children:(0,b.jsx)("p",{className:"text-slate-500 italic",children:"Paciente não encontrado"})})]})}a.s(["default",()=>x],84334)}];

//# sourceMappingURL=app_pacientes_%5Bid%5D_page_tsx_86f60e7c._.js.map