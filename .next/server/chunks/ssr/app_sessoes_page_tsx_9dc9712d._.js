module.exports=[43572,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(29662),e=a.i(38246),f=a.i(50944),g=a.i(14942);function h(){let{isLoaded:a,userId:h}=(0,d.useAuth)(),i=(0,f.useRouter)(),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)("now"),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)("todas"),[F,G]=(0,c.useState)("semana"),[H,I]=(0,c.useState)(1);(0,c.useEffect)(()=>{a&&h&&J()},[a,h]);let J=async()=>{try{o(!0);let[a,b]=await Promise.all([fetch("/api/sessions"),fetch("/api/patients")]);if(a.ok){let b=await a.json();k(b.sessions||[])}if(b.ok){let a=await b.json();m(a.patients||[])}}catch(a){console.error("Erro:",a)}finally{o(!1)}},K=async()=>{if(r){if("schedule"===t&&(!v||!x))return void alert("Selecione data e hora para agendar");try{A(!0);let a={patient_id:r};"now"===t?a.start_now=!0:(a.start_now=!1,a.scheduled_at=new Date(v+"T"+x+":00").toISOString());let b=await fetch("/api/sessions/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(b.ok){let a=await b.json();q(!1),s(""),w(""),y(""),u("now"),"now"===t?i.push("/sessoes/"+a.session.id):J()}}catch(a){console.error("Erro:",a)}finally{A(!1)}}},L=j.filter(a=>{let b=a.scheduled_at||a.started_at||a.created_at,c=""===B||a.patient_name.toLowerCase().includes(B.toLowerCase()),d="todas"===D||"agendadas"===D&&"agendada"===a.status||"finalizadas"===D&&"finalizada"===a.status||"em_andamento"===D&&"em_andamento"===a.status,e=!0;if("hoje"===F){let a,c;a=new Date(b),c=new Date,e=a.toDateString()===c.toDateString()}else if("amanha"===F){let a,c;a=new Date(b),(c=new Date).setDate(c.getDate()+1),e=a.toDateString()===c.toDateString()}else if("semana"===F){let a,c,d,f;a=new Date(b),(d=new Date(c=new Date)).setDate(c.getDate()-c.getDay()),(f=new Date(d)).setDate(d.getDate()+6),e=a>=d&&a<=f}else if("proxima_semana"===F){let a,c,d,f;a=new Date(b),(d=new Date(c=new Date)).setDate(c.getDate()-c.getDay()+7),(f=new Date(d)).setDate(d.getDate()+6),e=a>=d&&a<=f}else{let a,c;"mes"===F&&(a=new Date(b),c=new Date,e=a.getMonth()===c.getMonth()&&a.getFullYear()===c.getFullYear())}return c&&d&&e}).sort((a,b)=>{let c=new Date(a.scheduled_at||a.started_at||a.created_at),d=new Date(b.scheduled_at||b.started_at||b.created_at);return c.getTime()-d.getTime()}),M=Math.ceil(L.length/15),N=L.slice((H-1)*15,15*H);return((0,c.useEffect)(()=>{I(1)},[B,D,F]),!a||n)?(0,b.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,b.jsx)(g.default,{}),(0,b.jsx)("main",{className:"md:ml-20 min-h-screen flex items-center justify-center",children:(0,b.jsx)("div",{className:"w-6 h-6 border-2 border-[#FC608F] border-t-transparent rounded-full animate-spin"})})]}):(0,b.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,b.jsx)(g.default,{}),(0,b.jsxs)("main",{className:"md:ml-20 min-h-screen pb-20 md:pb-8",children:[(0,b.jsx)("div",{className:"flex justify-center pt-5 md:pt-6 mb-6 md:mb-8 px-4",children:(0,b.jsxs)("nav",{className:"inline-flex items-center gap-1 bg-white border border-slate-200 rounded-full px-3 md:px-5 py-1.5 shadow-sm",children:[(0,b.jsx)(e.default,{href:"/dashboard",className:"px-3 py-1 text-sm font-medium text-slate-400 hover:text-slate-600 transition-colors",children:"Hoje"}),(0,b.jsx)("span",{className:"text-slate-300 text-xs",children:"·"}),(0,b.jsx)(e.default,{href:"/sessoes",className:"px-3 py-1 text-sm font-medium text-[#FC608F]",children:"Sessões"}),(0,b.jsx)("span",{className:"text-slate-300 text-xs",children:"·"}),(0,b.jsx)(e.default,{href:"/pacientes",className:"px-3 py-1 text-sm font-medium text-slate-400 hover:text-slate-600 transition-colors",children:"Pacientes"}),(0,b.jsx)("span",{className:"text-slate-300 text-xs hidden sm:inline",children:"·"}),(0,b.jsx)(e.default,{href:"/sugestoes",className:"hidden sm:inline px-3 py-1 text-sm font-medium text-slate-400 hover:text-slate-600 transition-colors",children:"Sugestões"})]})}),(0,b.jsxs)("div",{className:"px-4 md:px-8 lg:px-12 xl:px-16",children:[(0,b.jsxs)("header",{className:"flex items-start justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-lg font-normal text-slate-400 tracking-tight mb-0",children:"Sessões"}),(0,b.jsx)("p",{className:"text-xs text-slate-300 font-light",children:"Histórico de sessões clínicas"})]}),(0,b.jsxs)("button",{onClick:()=>q(!0),"data-onboarding":"new-session",className:"flex items-center gap-2 px-5 py-2.5 bg-[#a2acb9]/20 text-[#344155] border border-[#a2acb9]/40 rounded-lg hover:bg-[#a2acb9]/30 transition-colors text-sm font-medium",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Nova Sessão"]})]}),(0,b.jsxs)("section",{className:"flex flex-col gap-3 mb-6 pb-6 border-b border-slate-100",children:[(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:[{value:"hoje",label:"Hoje"},{value:"amanha",label:"Amanhã"},{value:"semana",label:"Esta semana"},{value:"proxima_semana",label:"Próxima semana"},{value:"mes",label:"Este mês"},{value:"todas",label:"Todas"}].map(a=>(0,b.jsx)("button",{onClick:()=>G(a.value),className:`px-3 py-1.5 text-sm rounded-lg transition-colors ${F===a.value?"bg-slate-200 text-slate-700 border border-slate-300":"bg-white text-slate-500 border border-slate-200 hover:bg-slate-50"}`,children:a.label},a.value))}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)("input",{type:"text",placeholder:"Buscar por paciente...",value:B,onChange:a=>C(a.target.value),className:"w-full px-4 py-2.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent"})}),(0,b.jsxs)("select",{value:D,onChange:a=>E(a.target.value),className:"px-4 py-2.5 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent bg-white",children:[(0,b.jsx)("option",{value:"todas",children:"Todos os status"}),(0,b.jsx)("option",{value:"agendadas",children:"Agendadas"}),(0,b.jsx)("option",{value:"em_andamento",children:"Em andamento"}),(0,b.jsx)("option",{value:"finalizadas",children:"Finalizadas"})]})]})]}),N.length>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"w-full overflow-x-auto",children:[(0,b.jsxs)("div",{className:"hidden md:grid grid-cols-12 gap-4 pb-3 border-b border-slate-200 text-xs uppercase tracking-wider text-slate-400 font-medium min-w-[700px]",children:[(0,b.jsx)("div",{className:"col-span-2",children:"Data"}),(0,b.jsx)("div",{className:"col-span-1",children:"Hora"}),(0,b.jsx)("div",{className:"col-span-4",children:"Paciente"}),(0,b.jsx)("div",{className:"col-span-1 text-center",children:"Sessão"}),(0,b.jsx)("div",{className:"col-span-1 text-center",children:"Push"}),(0,b.jsx)("div",{className:"col-span-3",children:"Status"})]}),(0,b.jsx)("div",{className:"flex flex-col min-w-[700px]",children:N.map(a=>{let c=a.scheduled_at||a.started_at||a.created_at;return(0,b.jsxs)("div",{onClick:()=>i.push(`/sessoes/${a.id}`),className:"group grid grid-cols-12 gap-4 py-4 items-center hover:bg-slate-50/50 transition-colors cursor-pointer border-b border-slate-100",children:[(0,b.jsx)("div",{className:"col-span-2",children:(0,b.jsx)("span",{className:"text-sm text-slate-700",children:c?new Date(c).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"-"})}),(0,b.jsx)("div",{className:"col-span-1",children:(0,b.jsx)("span",{className:"text-sm text-slate-500",children:c?new Date(c).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):""})}),(0,b.jsx)("div",{className:"col-span-4",children:(0,b.jsx)("span",{className:"text-base font-medium text-slate-900",children:a.patient_name})}),(0,b.jsx)("div",{className:"col-span-1 text-center",children:(0,b.jsxs)("span",{className:"text-sm text-slate-500",children:["#",a.session_number]})}),(0,b.jsx)("div",{className:"col-span-1 flex justify-center",children:a.push_enabled?(0,b.jsx)("svg",{className:"w-5 h-5 text-emerald-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}):(0,b.jsxs)("svg",{className:"w-5 h-5 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 3l18 18"})]})}),(0,b.jsx)("div",{className:"col-span-3",children:(0,b.jsxs)("span",{className:`inline-flex items-center gap-1.5 text-sm ${((a,b)=>{if("em_andamento"===a)return"text-[#FC608F]";if("finalizada"===a)return"text-slate-400";if("cancelada"===a)return"text-slate-400 line-through";if("agendada"===a)switch(b){case"accepted":return"text-emerald-600";case"declined":return"text-rose-500";case"tentative":return"text-amber-500";default:return"text-slate-600"}return"text-slate-500"})(a.status,a.patient_response)}`,children:[(0,b.jsx)("span",{className:`w-1.5 h-1.5 rounded-full ${((a,b)=>{if("em_andamento"===a)return"bg-[#FC608F]";if("finalizada"===a||"cancelada"===a)return"bg-slate-300";if("agendada"===a)switch(b){case"accepted":return"bg-emerald-500";case"declined":return"bg-rose-500";default:return"bg-amber-400"}return"bg-slate-400"})(a.status,a.patient_response)}`}),((a,b)=>{if("em_andamento"===a)return"Em andamento";if("finalizada"===a)return"Finalizada";if("cancelada"===a)return"Cancelada";if("agendada"===a)switch(b){case"accepted":return"Confirmada";case"declined":return"Recusada";case"tentative":return"Pendente";default:return"Agendada"}return a})(a.status,a.patient_response)]})})]},a.id)})})]}),M>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between mt-6 pt-6 border-t border-slate-100",children:[(0,b.jsxs)("span",{className:"text-sm text-slate-500",children:["Página ",H," de ",M," · ",L.length," sessões"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>I(a=>Math.max(1,a-1)),disabled:1===H,className:"px-3 py-1.5 text-sm border border-slate-200 rounded-lg hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"← Anterior"}),(0,b.jsx)("button",{onClick:()=>I(a=>Math.min(M,a+1)),disabled:H===M,className:"px-3 py-1.5 text-sm border border-slate-200 rounded-lg hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Próxima →"})]})]})]}):(0,b.jsx)("div",{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-slate-400 italic",children:B||"todas"!==D||"todas"!==F?"Nenhuma sessão encontrada com esses filtros":"Nenhuma sessão registrada"})})]})]}),p&&(0,b.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-100",children:[(0,b.jsx)("h2",{className:"font-serif text-xl font-light text-slate-900",children:"Nova Sessão"}),(0,b.jsx)("button",{onClick:()=>q(!1),className:"text-slate-400 hover:text-slate-600",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-5",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Paciente"}),(0,b.jsxs)("select",{value:r,onChange:a=>s(a.target.value),className:"w-full px-4 py-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm",children:[(0,b.jsx)("option",{value:"",children:"Escolha um paciente..."}),l.map(a=>(0,b.jsx)("option",{value:a.id,children:a.full_name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Quando"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>u("now"),className:`px-4 py-3 rounded-lg border-2 text-sm font-medium transition-colors ${"now"===t?"border-[#FC608F] bg-[#FC608F]/10 text-[#FC608F]":"border-slate-200 text-slate-600 hover:border-slate-300"}`,children:"Iniciar Agora"}),(0,b.jsx)("button",{type:"button",onClick:()=>u("schedule"),className:`px-4 py-3 rounded-lg border-2 text-sm font-medium transition-colors ${"schedule"===t?"border-[#FC608F] bg-[#FC608F]/10 text-[#FC608F]":"border-slate-200 text-slate-600 hover:border-slate-300"}`,children:"Agendar"})]})]}),"schedule"===t&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Data"}),(0,b.jsx)("input",{type:"date",value:v,onChange:a=>w(a.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Hora"}),(0,b.jsx)("input",{type:"time",value:x,onChange:a=>y(a.target.value),className:"w-full px-4 py-3 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 p-6 border-t border-slate-100 bg-slate-50 rounded-b-xl",children:[(0,b.jsx)("button",{onClick:()=>q(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-200 rounded-lg text-sm",children:"Cancelar"}),(0,b.jsx)("button",{onClick:K,disabled:z||!r,className:"px-5 py-2 bg-[#FC608F] text-white rounded-lg hover:bg-[#FC608F]/90 disabled:opacity-50 text-sm font-medium flex items-center gap-2",children:z?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Criando..."]}):"now"===t?"Iniciar Sessão":"Agendar Sessão"})]})]})})]})}a.s(["default",()=>h])}];

//# sourceMappingURL=app_sessoes_page_tsx_9dc9712d._.js.map