module.exports=[73423,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246);let f={independent:"Independente",gestural:"Gestual",verbal:"Verbal",modeling:"Modelagem",partial_physical:"Física parcial",full_physical:"Física total"};function g(){let a=(0,d.useParams)(),g=(0,d.useSearchParams)(),h=a.id,i=g.get("protocol_id"),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)({trials_total:10,trials_correct:0,prompt_level:"independent",notes:""}),x=(0,c.useCallback)(async()=>{let a=`/api/aba/maintenance?learner_id=${h}`;i&&(a+=`&protocol_id=${i}`);try{let b=await fetch(a),c=await b.json();k(c.probes||[])}catch{}m(!1)},[h,i]);(0,c.useEffect)(()=>{x()},[x]);let y=async()=>{if(i){o("schedule"),q(null);try{let a=await fetch("/api/aba/maintenance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"schedule",protocol_id:i})}),b=await a.json();a.ok?(s(`${b.scheduled} sonda(s) agendada(s)`),x()):q(b.error||"Erro")}catch{q("Falha de conexão")}o(null)}},z=async a=>{o(a),q(null),s(null);try{let b=await fetch("/api/aba/maintenance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"evaluate",probe_id:a,trials_total:v.trials_total,trials_correct:v.trials_correct,prompt_level:v.prompt_level,notes:v.notes||null})}),c=await b.json();b.ok?(c.regression?s(`Sonda falhou (${c.score_pct}%). Regress\xe3o — protocolo voltou para Ativo.`):s(`Sonda aprovada (${c.score_pct}%)!`),u(null),w({trials_total:10,trials_correct:0,prompt_level:"independent",notes:""}),x()):q(c.error||"Erro")}catch{q("Falha de conexão")}o(null)};if(l)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[40vh]",children:(0,b.jsx)("p",{className:"text-slate-400 text-sm animate-pulse",children:"Carregando..."})});let A=j.filter(a=>"pending"===a.status),B=j.filter(a=>"completed"===a.status);return(0,b.jsxs)("div",{className:"px-4 md:px-8 lg:px-12 xl:px-16 pt-5",children:[(0,b.jsx)(e.default,{href:`/aba/aprendizes/${h}`,className:"text-xs text-slate-400 hover:text-aba-500",children:"← Voltar ao aprendiz"}),(0,b.jsxs)("div",{className:"mt-4 mb-6 flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-lg font-normal text-slate-800",children:"Manutenção — Sondas"}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Sondas pós-domínio (2, 6 e 12 semanas)"})]}),i&&(0,b.jsx)("button",{onClick:y,disabled:"schedule"===n,className:"px-4 py-2 text-xs bg-aba-500 text-white rounded-lg hover:bg-aba-600 disabled:opacity-50",children:"schedule"===n?"Agendando...":"Agendar Sondas 2-6-12"})]}),p&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-red-50 rounded-lg",children:(0,b.jsx)("p",{className:"text-xs text-red-500",children:p})}),r&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-green-50 rounded-lg",children:(0,b.jsx)("p",{className:"text-xs text-green-600",children:r})}),0===j.length?(0,b.jsx)("div",{className:"text-center py-12",children:(0,b.jsx)("p",{className:"text-sm text-slate-400",children:"Nenhuma sonda agendada."})}):(0,b.jsxs)(b.Fragment,{children:[A.length>0&&(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("h2",{className:"text-xs font-medium text-aba-500 uppercase tracking-wider mb-3",children:["Pendentes (",A.length,")"]}),(0,b.jsx)("div",{className:"space-y-2",children:A.map(a=>(0,b.jsxs)("div",{className:"p-4 rounded-xl border border-amber-200 bg-amber-50/50",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-slate-800",children:a.label}),(0,b.jsxs)("p",{className:"text-[11px] text-slate-400",children:[a.protocol_title," · ",new Date(a.scheduled_at).toLocaleDateString("pt-BR")]})]}),new Date(a.scheduled_at)<=new Date?(0,b.jsx)("button",{onClick:()=>u(t===a.id?null:a.id),className:"px-3 py-1 text-[11px] bg-aba-500 text-white rounded-lg hover:bg-aba-600",children:t===a.id?"Cancelar":"Avaliar"}):(0,b.jsx)("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-medium bg-blue-50 text-blue-500",children:"Futura"})]}),t===a.id&&(0,b.jsxs)("div",{className:"mt-3 pt-3 border-t border-amber-200",children:[(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[11px] text-slate-500 mb-1",children:"Total tentativas"}),(0,b.jsx)("input",{type:"number",min:1,value:v.trials_total,onChange:a=>w({...v,trials_total:parseInt(a.target.value)||0}),className:"w-full px-3 py-1.5 text-sm border border-slate-200 rounded-lg focus:outline-none focus:border-aba-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[11px] text-slate-500 mb-1",children:"Corretas"}),(0,b.jsx)("input",{type:"number",min:0,value:v.trials_correct,onChange:a=>w({...v,trials_correct:parseInt(a.target.value)||0}),className:"w-full px-3 py-1.5 text-sm border border-slate-200 rounded-lg focus:outline-none focus:border-aba-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[11px] text-slate-500 mb-1",children:"Nível de dica"}),(0,b.jsx)("select",{value:v.prompt_level,onChange:a=>w({...v,prompt_level:a.target.value}),className:"w-full px-3 py-1.5 text-sm border border-slate-200 rounded-lg focus:outline-none focus:border-aba-500 bg-white",children:Object.entries(f).map(([a,c])=>(0,b.jsx)("option",{value:a,children:c},a))})]})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)("button",{onClick:()=>z(a.id),disabled:n===a.id,className:"px-4 py-1.5 text-xs bg-aba-500 text-white rounded-lg hover:bg-aba-600 disabled:opacity-50",children:n===a.id?"Salvando...":"Registrar Resultado"})})]})]},a.id))})]}),B.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider mb-3",children:["Concluídas (",B.length,")"]}),(0,b.jsx)("div",{className:"space-y-2",children:B.map(a=>(0,b.jsx)("div",{className:`p-4 rounded-xl border ${"passed"===a.result?"border-green-200 bg-green-50/30":"border-red-200 bg-red-50/30"}`,children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-slate-800",children:a.label}),(0,b.jsxs)("p",{className:"text-[11px] text-slate-400",children:[a.protocol_title," · ",a.trials_correct,"/",a.trials_total," (",a.score_pct,"%)"]})]}),(0,b.jsx)("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium ${"passed"===a.result?"bg-green-100 text-green-600":"bg-red-100 text-red-500"}`,children:"passed"===a.result?"Mantida":"Regressão"})]})},a.id))})]})]})]})}a.s(["default",()=>g])}];

//# sourceMappingURL=app_aba_aprendizes_%5Bid%5D_manutencao_page_tsx_63c0a9f2._.js.map