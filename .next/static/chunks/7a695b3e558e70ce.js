(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,38927,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),l=e.i(22016);let r={independent:"Independente",gestural:"Gestual",verbal:"Verbal",modeling:"Modelagem",partial_physical:"Física parcial",full_physical:"Física total"};function n(){let e=(0,s.useParams)(),n=(0,s.useSearchParams)(),d=e.id,i=n.get("protocol_id"),[c,o]=(0,a.useState)([]),[x,p]=(0,a.useState)(!0),[u,m]=(0,a.useState)(null),[h,b]=(0,a.useState)(null),[g,j]=(0,a.useState)(null),[v,f]=(0,a.useState)(null),[N,y]=(0,a.useState)({trials_total:10,trials_correct:0,prompt_level:"independent",notes:""}),_=(0,a.useCallback)(async()=>{let e=`/api/aba/maintenance?learner_id=${d}`;i&&(e+=`&protocol_id=${i}`);try{let t=await fetch(e),a=await t.json();o(a.probes||[])}catch{}p(!1)},[d,i]);(0,a.useEffect)(()=>{_()},[_]);let w=async()=>{if(i){m("schedule"),b(null);try{let e=await fetch("/api/aba/maintenance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"schedule",protocol_id:i})}),t=await e.json();e.ok?(j(`${t.scheduled} sonda(s) agendada(s)`),_()):b(t.error||"Erro")}catch{b("Falha de conexão")}m(null)}},S=async e=>{m(e),b(null),j(null);try{let t=await fetch("/api/aba/maintenance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"evaluate",probe_id:e,trials_total:N.trials_total,trials_correct:N.trials_correct,prompt_level:N.prompt_level,notes:N.notes||null})}),a=await t.json();t.ok?(a.regression?j(`Sonda falhou (${a.score_pct}%). Regress\xe3o — protocolo voltou para Ativo.`):j(`Sonda aprovada (${a.score_pct}%)!`),f(null),y({trials_total:10,trials_correct:0,prompt_level:"independent",notes:""}),_()):b(a.error||"Erro")}catch{b("Falha de conexão")}m(null)};if(x)return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[40vh]",children:(0,t.jsx)("p",{className:"text-slate-400 text-sm animate-pulse",children:"Carregando..."})});let C=c.filter(e=>"pending"===e.status),k=c.filter(e=>"completed"===e.status);return(0,t.jsxs)("div",{className:"px-4 md:px-8 lg:px-12 xl:px-16 pt-5",children:[(0,t.jsx)(l.default,{href:`/aba/aprendizes/${d}`,className:"text-xs text-slate-400 hover:text-aba-500",children:"← Voltar ao aprendiz"}),(0,t.jsxs)("div",{className:"mt-4 mb-6 flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-lg font-normal text-slate-800",children:"Manutenção — Sondas"}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Sondas pós-domínio (2, 6 e 12 semanas)"})]}),i&&(0,t.jsx)("button",{onClick:w,disabled:"schedule"===u,className:"px-4 py-2 text-xs bg-aba-500 text-white rounded-lg hover:bg-aba-600 disabled:opacity-50",children:"schedule"===u?"Agendando...":"Agendar Sondas 2-6-12"})]}),h&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-red-50 rounded-lg",children:(0,t.jsx)("p",{className:"text-xs text-red-500",children:h})}),g&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-green-50 rounded-lg",children:(0,t.jsx)("p",{className:"text-xs text-green-600",children:g})}),0===c.length?(0,t.jsx)("div",{className:"text-center py-12",children:(0,t.jsx)("p",{className:"text-sm text-slate-400",children:"Nenhuma sonda agendada."})}):(0,t.jsxs)(t.Fragment,{children:[C.length>0&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("h2",{className:"text-xs font-medium text-aba-500 uppercase tracking-wider mb-3",children:["Pendentes (",C.length,")"]}),(0,t.jsx)("div",{className:"space-y-2",children:C.map(e=>(0,t.jsxs)("div",{className:"p-4 rounded-xl border border-amber-200 bg-amber-50/50",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-slate-800",children:e.label}),(0,t.jsxs)("p",{className:"text-[11px] text-slate-400",children:[e.protocol_title," · ",new Date(e.scheduled_at).toLocaleDateString("pt-BR")]})]}),new Date(e.scheduled_at)<=new Date?(0,t.jsx)("button",{onClick:()=>f(v===e.id?null:e.id),className:"px-3 py-1 text-[11px] bg-aba-500 text-white rounded-lg hover:bg-aba-600",children:v===e.id?"Cancelar":"Avaliar"}):(0,t.jsx)("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-medium bg-blue-50 text-blue-500",children:"Futura"})]}),v===e.id&&(0,t.jsxs)("div",{className:"mt-3 pt-3 border-t border-amber-200",children:[(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-[11px] text-slate-500 mb-1",children:"Total tentativas"}),(0,t.jsx)("input",{type:"number",min:1,value:N.trials_total,onChange:e=>y({...N,trials_total:parseInt(e.target.value)||0}),className:"w-full px-3 py-1.5 text-sm border border-slate-200 rounded-lg focus:outline-none focus:border-aba-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-[11px] text-slate-500 mb-1",children:"Corretas"}),(0,t.jsx)("input",{type:"number",min:0,value:N.trials_correct,onChange:e=>y({...N,trials_correct:parseInt(e.target.value)||0}),className:"w-full px-3 py-1.5 text-sm border border-slate-200 rounded-lg focus:outline-none focus:border-aba-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-[11px] text-slate-500 mb-1",children:"Nível de dica"}),(0,t.jsx)("select",{value:N.prompt_level,onChange:e=>y({...N,prompt_level:e.target.value}),className:"w-full px-3 py-1.5 text-sm border border-slate-200 rounded-lg focus:outline-none focus:border-aba-500 bg-white",children:Object.entries(r).map(([e,a])=>(0,t.jsx)("option",{value:e,children:a},e))})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{onClick:()=>S(e.id),disabled:u===e.id,className:"px-4 py-1.5 text-xs bg-aba-500 text-white rounded-lg hover:bg-aba-600 disabled:opacity-50",children:u===e.id?"Salvando...":"Registrar Resultado"})})]})]},e.id))})]}),k.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider mb-3",children:["Concluídas (",k.length,")"]}),(0,t.jsx)("div",{className:"space-y-2",children:k.map(e=>(0,t.jsx)("div",{className:`p-4 rounded-xl border ${"passed"===e.result?"border-green-200 bg-green-50/30":"border-red-200 bg-red-50/30"}`,children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-slate-800",children:e.label}),(0,t.jsxs)("p",{className:"text-[11px] text-slate-400",children:[e.protocol_title," · ",e.trials_correct,"/",e.trials_total," (",e.score_pct,"%)"]})]}),(0,t.jsx)("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium ${"passed"===e.result?"bg-green-100 text-green-600":"bg-red-100 text-red-500"}`,children:"passed"===e.result?"Mantida":"Regressão"})]})},e.id))})]})]})]})}e.s(["default",()=>n])}]);