(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},27204,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),r=e.i(45423),i=e.i(43531),n=e.i(37727),l=e.i(31278);function c(){let c=(0,s.useSearchParams)().get("token"),[o,d]=(0,a.useState)("loading"),[m,x]=(0,a.useState)(""),[u,h]=(0,a.useState)("");(0,a.useEffect)(()=>{if(!c){d("error"),h("Link invalido");return}d("ready")},[c]);let b=async()=>{if(!("Notification"in window)){d("error"),h("Seu navegador não suporta notificações");return}try{d("activating");let t=await Notification.requestPermission();if("granted"!==t)return void d("denied");let a=await navigator.serviceWorker.register("/firebase-messaging-sw.js"),{initializeApp:s,getApps:r}=await e.A(28515),{getMessaging:i,getToken:n}=await e.A(77476),l=0===r().length?s({apiKey:"AIzaSyCl15IE6pCSWywO-4IiPX0QtLqy4BiXL4E",authDomain:"axis-tcc.firebaseapp.com",projectId:"axis-tcc",storageBucket:"axis-tcc.firebasestorage.app",messagingSenderId:"911481168774",appId:"1:911481168774:web:8a030d698db7046485c207"}):r()[0],o=i(l),m=await n(o,{vapidKey:"BOsFvrRAsH7tSNcG9Y4fuxsez-DveZues3qrPZjjiewrOeqiuequgrijDQsRP6ZpEOX2KCWfaynNey0yzCtjWdo",serviceWorkerRegistration:a});if(!m){d("error"),h("Não foi possível ativar notificações");return}let u=await fetch("/api/patient/push/authorize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_token:c,fcm_token:m,device_info:navigator.userAgent})}),b=await u.json();u.ok?(x(b.patient_name||""),d("success")):(d("error"),h(b.error||"Erro ao ativar"))}catch(e){console.error("Erro:",e),d("error"),h("Erro ao ativar notificações")}};return(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg max-w-md w-full p-8",children:["loading"===o&&(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(l.Loader2,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto"})}),"ready"===o&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)(r.Bell,{className:"w-10 h-10 text-blue-600"})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 mb-3",children:"Ativar Lembretes"}),(0,t.jsx)("p",{className:"text-neutral-600 mb-6",children:"Receba lembretes das suas sessoes diretamente no seu celular ou computador."}),(0,t.jsx)("p",{className:"text-sm text-neutral-500 mb-8 bg-neutral-50 p-4 rounded-lg",children:"Você recebera apenas lembretes de horario das suas sessoes. Nenhuma informacao clínica sera enviada."}),(0,t.jsx)("button",{onClick:b,className:"w-full px-6 py-4 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-semibold text-lg transition-colors",children:"Ativar Notificações"})]}),"activating"===o&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(l.Loader2,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-neutral-600",children:"Ativando notificações..."})]}),"success"===o&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-full bg-emerald-100 flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)(i.Check,{className:"w-10 h-10 text-emerald-600"})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 mb-3",children:"Lembretes Ativados!"}),(0,t.jsxs)("p",{className:"text-neutral-600 mb-4",children:[m?`${m}, voc\xea`:"Você"," recebera lembretes antes das suas sessoes."]}),(0,t.jsx)("p",{className:"text-sm text-neutral-500",children:"Pode fechar esta página."})]}),"denied"===o&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-full bg-amber-100 flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)(r.Bell,{className:"w-10 h-10 text-amber-600"})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 mb-3",children:"Permissao Negada"}),(0,t.jsx)("p",{className:"text-neutral-600 mb-6",children:"Para receber lembretes, você precisa permitir notificações no seu navegador."}),(0,t.jsx)("button",{onClick:()=>d("ready"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Tentar Novamente"})]}),"error"===o&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-full bg-red-100 flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)(n.X,{className:"w-10 h-10 text-red-600"})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 mb-3",children:"Erro"}),(0,t.jsx)("p",{className:"text-neutral-600",children:u||"Não foi possível ativar os lembretes."})]}),(0,t.jsx)("div",{className:"mt-8 pt-6 border-t border-neutral-100 text-center",children:(0,t.jsx)("p",{className:"text-xs text-neutral-400",children:"AXIS TCC - Sistema de Apoio Clínico"})})]})}function o(){return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-white flex items-center justify-center p-4",children:(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(l.Loader2,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto"})}),children:(0,t.jsx)(c,{})})})}e.s(["default",()=>o])}]);