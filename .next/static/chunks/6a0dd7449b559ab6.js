(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,30921,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(22016);let a={critico:"#ef4444",alerta:"#f59e0b",moderado:"#3b82f6",bom:"#22c55e",excelente:"#10b981"};function r(e){return e<40?"critico":e<55?"alerta":e<70?"moderado":e<85?"bom":"excelente"}function d({data:e,width:s=600,height:l=180}){if(!e.length)return(0,t.jsx)("div",{className:"flex items-center justify-center h-32 text-xs text-slate-300",children:"Sem dados"});let d=s-35-10,i=l-10-25,c=e.map((t,s)=>({x:35+(1===e.length?d/2:s/(e.length-1)*d),y:10+i-t.cso_aba/100*i,cso:t.cso_aba,date:t.session_date})),n=c.map((e,t)=>`${0===t?"M":"L"} ${e.x} ${e.y}`).join(" "),x=n+` L ${c[c.length-1].x} ${10+i} L ${c[0].x} ${10+i} Z`,o=0;return(0,t.jsxs)("svg",{width:s,height:l,children:[[{y2:40,c:"#fef2f2"},{y2:55,c:"#fffbeb"},{y2:70,c:"#eff6ff"},{y2:85,c:"#f0fdf4"},{y2:100,c:"#ecfdf5"}].map((e,s)=>{let l=10+i-e.y2/100*i,a=(e.y2-o)/100*i;return o=e.y2,(0,t.jsx)("rect",{x:35,y:l,width:d,height:a,fill:e.c},s)}),[0,25,50,75,100].map(e=>{let s=10+i-e/100*i;return(0,t.jsxs)("g",{children:[(0,t.jsx)("line",{x1:35,y1:s,x2:35+d,y2:s,stroke:"#e2e8f0",strokeWidth:.5}),(0,t.jsx)("text",{x:30,y:s+3,textAnchor:"end",fontSize:9,fill:"#94a3b8",children:e})]},e)}),(0,t.jsx)("path",{d:x,fill:"#e07a2f",opacity:.15}),(0,t.jsx)("path",{d:n,fill:"none",stroke:"#e07a2f",strokeWidth:2}),c.map((s,l)=>(0,t.jsxs)("g",{children:[(0,t.jsx)("circle",{cx:s.x,cy:s.y,r:4,fill:"white",stroke:a[r(s.cso)],strokeWidth:2}),e.length<=10&&(0,t.jsx)("text",{x:s.x,y:10+i+15,textAnchor:"middle",fontSize:8,fill:"#94a3b8",children:new Date(s.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})})]},l))]})}function i(){var e;let[i,c]=(0,s.useState)([]),[n,x]=(0,s.useState)(""),[o,m]=(0,s.useState)([]),[h,p]=(0,s.useState)({total:0,completed:0,scheduled:0}),[f,u]=(0,s.useState)({total:0,active:0,mastered:0,maintained:0}),[j,b]=(0,s.useState)(!0);(0,s.useEffect)(()=>{fetch("/api/aba/learners").then(e=>e.json()).then(e=>{let t=e.learners||[];c(t),t.length>0&&x(t[0].id),b(!1)}).catch(()=>b(!1))},[]),(0,s.useEffect)(()=>{n&&Promise.all([fetch(`/api/aba/learners/${n}/cso-history`).then(e=>e.json()),fetch(`/api/aba/sessions?learner_id=${n}`).then(e=>e.json()),fetch(`/api/aba/protocols?learner_id=${n}`).then(e=>e.json())]).then(([e,t,s])=>{m(e.history||[]);let l=t.sessions||[];p({total:l.length,completed:l.filter(e=>"completed"===e.status).length,scheduled:l.filter(e=>"scheduled"===e.status).length});let a=s.protocols||[];u({total:a.length,active:a.filter(e=>"active"===e.status).length,mastered:a.filter(e=>"mastered"===e.status).length,maintained:a.filter(e=>"maintained"===e.status).length})}).catch(()=>{})},[n]);let g=o.length>0?o[o.length-1]:null,N=o.length>1?o[o.length-2]:null,v=g&&N?g.cso_aba-N.cso_aba:0;return j?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[50vh]",children:(0,t.jsx)("p",{className:"text-slate-400 text-sm animate-pulse",children:"Carregando..."})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex justify-center pt-5 mb-6 px-4",children:(0,t.jsxs)("nav",{className:"inline-flex items-center gap-1 bg-white border border-slate-200 rounded-full px-3 md:px-5 py-1.5 shadow-sm",children:[(0,t.jsx)(l.default,{href:"/aba",className:"px-3 py-1 text-sm font-medium text-slate-400 hover:text-slate-600",children:"Painel"}),(0,t.jsx)("span",{className:"text-slate-300 text-xs",children:"·"}),(0,t.jsx)(l.default,{href:"/aba/aprendizes",className:"px-3 py-1 text-sm font-medium text-slate-400 hover:text-slate-600",children:"Aprendizes"}),(0,t.jsx)("span",{className:"text-slate-300 text-xs",children:"·"}),(0,t.jsx)(l.default,{href:"/aba/sessoes",className:"px-3 py-1 text-sm font-medium text-slate-400 hover:text-slate-600",children:"Sessoes"}),(0,t.jsx)("span",{className:"text-slate-300 text-xs",children:"·"}),(0,t.jsx)(l.default,{href:"/aba/relatorios",className:"px-3 py-1 text-sm font-medium text-slate-400 hover:text-slate-600",children:"Relatorios"})]})}),(0,t.jsxs)("div",{className:"px-4 md:px-8 lg:px-12 xl:px-16",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-lg font-normal text-slate-400",children:"Dashboard Clinico"}),(0,t.jsx)("p",{className:"text-xs text-slate-300",children:"Progresso terapeutico"})]}),i.length>1&&(0,t.jsx)("select",{value:n,onChange:e=>x(e.target.value),className:"px-3 py-1.5 text-sm border border-slate-200 rounded-lg bg-white",children:i.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"md:col-span-2 p-5 rounded-2xl border border-slate-200 bg-white",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-sm font-medium text-slate-800",children:"Evolucao CSO-ABA"}),(0,t.jsxs)("p",{className:"text-[11px] text-slate-400",children:["Motor v2.6.1 - ",o.length," pontos"]})]}),g&&(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-2xl font-medium",style:{color:a[r(g.cso_aba)]},children:g.cso_aba}),(0,t.jsxs)("p",{className:"text-[10px]",style:{color:a[r(g.cso_aba)]},children:[(e=g.cso_aba)<40?"Critico":e<55?"Alerta":e<70?"Moderado":e<85?"Bom":"Excelente",0!==v&&(0,t.jsxs)("span",{className:v>0?"text-green-500":"text-red-500",children:[" (",v>0?"+":"",v.toFixed(1),")"]})]})]})]}),(0,t.jsx)(d,{data:o})]}),(0,t.jsxs)("div",{className:"p-4 rounded-2xl border border-slate-200 bg-white",children:[(0,t.jsx)("h3",{className:"text-xs font-medium text-slate-600 mb-3",children:"Dimensoes"}),g?(0,t.jsx)("div",{className:"space-y-2",children:[{l:"SAS",v:g.sas,d:"Aquisicao"},{l:"PIS",v:g.pis,d:"Implementacao"},{l:"BSS",v:g.bss,d:"Comportamento"},{l:"TCM",v:g.tcm,d:"Tratamento"}].map(e=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between mb-0.5",children:[(0,t.jsxs)("span",{className:"text-[11px] text-slate-500",children:[e.l," ",(0,t.jsxs)("span",{className:"text-slate-300",children:["(",e.d,")"]})]}),(0,t.jsx)("span",{className:"text-xs font-medium text-slate-700",children:e.v})]}),(0,t.jsx)("div",{className:"h-1.5 bg-slate-100 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full rounded-full",style:{width:`${e.v}%`,backgroundColor:a[r(e.v)]}})})]},e.l))}):(0,t.jsx)("p",{className:"text-xs text-slate-300",children:"Sem dados"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"p-4 rounded-xl bg-blue-50/50 border border-blue-100",children:[(0,t.jsx)("p",{className:"text-2xl font-medium text-blue-600",children:f.active}),(0,t.jsx)("p",{className:"text-[11px] text-slate-500",children:"Protocolos ativos"})]}),(0,t.jsxs)("div",{className:"p-4 rounded-xl bg-green-50/50 border border-green-100",children:[(0,t.jsx)("p",{className:"text-2xl font-medium text-green-600",children:f.mastered+f.maintained}),(0,t.jsx)("p",{className:"text-[11px] text-slate-500",children:"Dominados"})]}),(0,t.jsxs)("div",{className:"p-4 rounded-xl bg-aba-500/5 border border-aba-500/20",children:[(0,t.jsx)("p",{className:"text-2xl font-medium text-aba-500",children:h.completed}),(0,t.jsx)("p",{className:"text-[11px] text-slate-500",children:"Sessoes concluidas"})]}),(0,t.jsxs)("div",{className:"p-4 rounded-xl bg-purple-50/50 border border-purple-100",children:[(0,t.jsx)("p",{className:"text-2xl font-medium text-purple-600",children:h.scheduled}),(0,t.jsx)("p",{className:"text-[11px] text-slate-500",children:"Agendadas"})]})]}),(0,t.jsxs)("div",{className:"p-4 rounded-xl border border-slate-200 bg-white",children:[(0,t.jsx)("h3",{className:"text-xs font-medium text-slate-600 mb-3",children:"Bandas CSO-ABA"}),(0,t.jsx)("div",{className:"flex gap-3 flex-wrap",children:[{l:"Critico",r:"0-39",c:"#ef4444"},{l:"Alerta",r:"40-54",c:"#f59e0b"},{l:"Moderado",r:"55-69",c:"#3b82f6"},{l:"Bom",r:"70-84",c:"#22c55e"},{l:"Excelente",r:"85-100",c:"#10b981"}].map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.c}}),(0,t.jsxs)("span",{className:"text-[11px] text-slate-500",children:[e.l," (",e.r,")"]})]},e.l))})]}),(0,t.jsx)("p",{className:"text-[10px] text-slate-300 text-center mt-8 mb-4",children:"AXIS ABA - Motor CSO-ABA v2.6.1"})]})]})}e.s(["default",()=>i])}]);