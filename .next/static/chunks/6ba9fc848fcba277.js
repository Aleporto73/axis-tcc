(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,79870,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(38703),r=e.i(18566),l=e.i(22016),n=e.i(82437),i=e.i(25652),o=e.i(35408),c=e.i(99023),d=e.i(3116),x=e.i(20278),m=e.i(21218),h=e.i(37727),u=e.i(78894),p=e.i(87316),g=e.i(86311);let j=(0,e.i(75254).default)("file-down",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);var f=e.i(43531);let b={auto:{border:"#e2e8f0",bg:"#f8fafc",label:"Cálculo automático",dot:"#cbd5e1"},professional:{border:"#bbf7d0",bg:"#f0fdf4",label:"Registro do Profissional",dot:"#86efac"},attention:{border:"#fde68a",bg:"#fffbeb",label:"Atenção",dot:"#fcd34d"}};function v({type:e,children:t,className:a=""}){let r=b[e];return(0,s.jsx)("div",{className:`rounded-xl overflow-hidden ${a}`,style:{border:`1px solid ${"attention"===e?"#fde68a":"#e5e7eb"}`},children:(0,s.jsxs)("div",{style:{display:"flex"},children:[(0,s.jsx)("div",{style:{width:"3px",flexShrink:0,backgroundColor:r.border,borderRadius:"3px 0 0 3px"}}),(0,s.jsx)("div",{style:{flex:1},children:t})]})})}function y({type:e}){let t=b[e];return(0,s.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,s.jsx)("span",{style:{width:6,height:6,borderRadius:"50%",backgroundColor:t.dot,display:"inline-block"}}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:t.label})]})}function N({patientId:e,patientName:a,sessionsCount:r,onClose:l}){let n,N,w,[k,C]=(0,t.useState)(null),[E,_]=(0,t.useState)(!0),[S,T]=(0,t.useState)(""),[R,O]=(0,t.useState)(!1),[U,L]=(0,t.useState)(""),[$,P]=(0,t.useState)(!1),[A,M]=(0,t.useState)(!1);(0,t.useEffect)(()=>{z()},[]);let z=async()=>{try{_(!0);let[s,t]=await Promise.all([fetch(`/api/patients/${e}/evolution`),fetch(`/api/patients/${e}/supervision`)]);if(s.ok){let t=await s.json();C(t),fetch("/api/audit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"REPORT_VIEW",entity_type:"report",entity_id:e,metadata:{report_type:"longitudinal",sessions_count:t.total_sessions}})})}else T("Erro ao carregar dados");if(t.ok){let e=await t.json();e.context&&(L(e.context),O(!0))}}catch(e){T("Erro ao carregar dados")}finally{_(!1)}},I=(0,t.useCallback)(async()=>{if(!$){P(!0),M(!1);try{(await fetch(`/api/patients/${e}/supervision`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({context:U})})).ok&&(M(!0),setTimeout(()=>M(!1),2e3))}catch(e){console.error("Erro ao salvar:",e)}finally{P(!1)}}},[e,U,$]);if(E)return(0,s.jsx)("div",{className:"bg-white rounded-2xl p-8 border border-gray-200 mt-6 shadow-sm",children:(0,s.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,s.jsx)("div",{className:"h-6 bg-gray-100 rounded w-1/3"}),(0,s.jsx)("div",{className:"h-32 bg-gray-50 rounded"})]})});if(S||!k)return(0,s.jsx)("div",{className:"bg-white rounded-2xl p-6 border border-gray-200 mt-6",children:(0,s.jsx)("p",{className:"text-gray-500",children:S||"Erro ao carregar dados"})});let D=Math.max(k.event_percentages.EVITOU,k.event_percentages.ENFRENTOU,k.event_percentages.AJUSTOU,k.event_percentages.RECUPEROU,1),B=[{label:"Evitou",value:k.event_percentages.EVITOU,angle:-90,color:"#d97706"},{label:"Enfrentou",value:k.event_percentages.ENFRENTOU,angle:0,color:"#059669"},{label:"Recuperou",value:k.event_percentages.RECUPEROU,angle:90,color:"#7c3aed"},{label:"Ajustou",value:k.event_percentages.AJUSTOU,angle:180,color:"#0891b2"}],V=(e,s)=>{let t=e/100*60,a=s*Math.PI/180;return{x:90+t*Math.cos(a),y:90+t*Math.sin(a)}},W=B.map((e,s)=>{let t=V(e.value,e.angle);return`${0===s?"M":"L"} ${t.x} ${t.y}`}).join(" ")+" Z";return(0,s.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-200 mt-6 overflow-hidden shadow-sm",children:[(0,s.jsx)("div",{className:"px-6 py-5 border-b border-gray-100",style:{backgroundColor:"#f0fdf4"},children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"font-serif text-2xl",style:{color:"#166534"},children:"Evolução do Processo"}),(0,s.jsxs)("p",{className:"text-sm mt-1",style:{color:"#15803d"},children:["Relatório longitudinal • ",k.total_sessions," sessões analisadas"]})]}),(0,s.jsx)("button",{onClick:l,className:"p-2 hover:bg-green-100 rounded-lg transition-colors",children:(0,s.jsx)(h.X,{className:"w-5 h-5",style:{color:"#16a34a"}})})]})}),(0,s.jsx)("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-100",children:(0,s.jsx)("p",{className:"text-xs text-gray-600",children:"Este relatório descreve padrões observáveis ao longo do tempo. Não contém inferência diagnóstica, interpretação psicológica ou juízo clínico."})}),(0,s.jsxs)("div",{className:"px-6 py-2.5 border-b border-gray-100 flex items-center gap-5",children:[(0,s.jsx)("span",{className:"text-xs text-gray-400 uppercase tracking-wide",style:{fontSize:"10px"},children:"Autoria:"}),Object.entries(b).map(([e,t])=>(0,s.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,s.jsx)("span",{style:{width:6,height:6,borderRadius:"50%",backgroundColor:t.dot,display:"inline-block"}}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:t.label})]},e))]}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsx)(v,{type:"auto",children:(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide",children:"Indicadores"}),(0,s.jsx)(y,{type:"auto"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(x.Target,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Sessões"})]}),(0,s.jsx)("p",{className:"text-3xl font-light text-gray-900",children:k.total_sessions}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"finalizadas"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(m.Activity,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Eventos"})]}),(0,s.jsx)("p",{className:"text-3xl font-light text-gray-900",children:k.total_events}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"registrados"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(d.Clock,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Recuperação"})]}),(0,s.jsx)("p",{className:"text-3xl font-light text-gray-900",children:k.avg_recovery_time||"-"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"min (média)"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:["up"===k.trend?(0,s.jsx)(i.TrendingUp,{className:"w-4 h-4 text-gray-400"}):"down"===k.trend?(0,s.jsx)(o.TrendingDown,{className:"w-4 h-4 text-gray-400"}):(0,s.jsx)(c.Minus,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Tendência"})]}),(0,s.jsx)("p",{className:"text-xl font-medium text-gray-900",children:"up"===k.trend?"Positiva":"down"===k.trend?"Observada":"Estável"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"últimas sessões"})]})]})]})}),(0,s.jsx)(v,{type:"auto",children:(0,s.jsxs)("div",{className:"p-5",style:{backgroundColor:"#f8fafc"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide",children:"Tendência de Processo"}),(0,s.jsx)(y,{type:"auto"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:(k.trend,n=Object.entries(k.event_counts).sort((e,s)=>s[1]-e[1]),k.total_events<3?"Dados insuficientes para caracterização de tendência no período analisado.":`Ao longo das sess\xf5es analisadas, a distribui\xe7\xe3o dos micro-eventos manteve configura\xe7\xe3o semelhante, com predomin\xe2ncia relativa de ${({EVITOU:"Evitação",ENFRENTOU:"Enfrentamento",AJUSTOU:"Ajuste",RECUPEROU:"Recuperação"})[n[0][0]]}. N\xe3o foram identificadas varia\xe7\xf5es progressivas sustentadas no perfil de eventos no per\xedodo.`)})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[k.total_events>=2&&(0,s.jsx)(v,{type:"auto",children:(0,s.jsxs)("div",{className:"p-5",style:{backgroundColor:"#f8fafc"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide",children:"Perfil de Distribuição"}),(0,s.jsx)(y,{type:"auto"})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("svg",{width:180,height:180,className:"overflow-visible",children:[[25,50,75,100].map(e=>(0,s.jsx)("circle",{cx:90,cy:90,r:e/100*60,fill:"none",stroke:"#e5e7eb",strokeWidth:"1"},e)),B.map((e,t)=>{let a=V(100,e.angle);return(0,s.jsx)("line",{x1:90,y1:90,x2:a.x,y2:a.y,stroke:"#e5e7eb",strokeWidth:"1"},t)}),(0,s.jsx)("path",{d:W,fill:"rgba(107, 114, 128, 0.1)",stroke:"#6b7280",strokeWidth:"1.5"}),B.map((e,t)=>{let a=V(e.value,e.angle);return(0,s.jsx)("circle",{cx:a.x,cy:a.y,r:"4",fill:e.color},t)}),B.map((e,t)=>{let a=V(120,e.angle);return(0,s.jsx)("text",{x:a.x,y:a.y,textAnchor:"middle",dominantBaseline:"middle",className:"text-xs fill-gray-500",children:e.label},t)})]})})]})}),(0,s.jsx)(v,{type:"auto",children:(0,s.jsxs)("div",{className:"p-5",style:{backgroundColor:"#f8fafc"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide",children:"Distribuição de Eventos"}),(0,s.jsx)(y,{type:"auto"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Evitou"}),(0,s.jsxs)("span",{className:"text-gray-500",children:[k.event_counts.EVITOU," (",k.event_percentages.EVITOU,"%)"]})]}),(0,s.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full rounded-full",style:{width:`${k.event_percentages.EVITOU/D*100}%`,backgroundColor:"#d97706"}})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Enfrentou"}),(0,s.jsxs)("span",{className:"text-gray-500",children:[k.event_counts.ENFRENTOU," (",k.event_percentages.ENFRENTOU,"%)"]})]}),(0,s.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full rounded-full",style:{width:`${k.event_percentages.ENFRENTOU/D*100}%`,backgroundColor:"#059669"}})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Ajustou"}),(0,s.jsxs)("span",{className:"text-gray-500",children:[k.event_counts.AJUSTOU," (",k.event_percentages.AJUSTOU,"%)"]})]}),(0,s.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full rounded-full",style:{width:`${k.event_percentages.AJUSTOU/D*100}%`,backgroundColor:"#0891b2"}})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Recuperou"}),(0,s.jsxs)("span",{className:"text-gray-500",children:[k.event_counts.RECUPEROU," (",k.event_percentages.RECUPEROU,"%)"]})]}),(0,s.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full rounded-full",style:{width:`${k.event_percentages.RECUPEROU/D*100}%`,backgroundColor:"#7c3aed"}})})]})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:(N=Object.entries(k.event_counts).sort((e,s)=>s[1]-e[1]),w={EVITOU:"Evitação",ENFRENTOU:"Enfrentamento",AJUSTOU:"Ajuste",RECUPEROU:"Recuperação"},`Maior frequ\xeancia de ${w[N[0][0]]} (${k.event_percentages[N[0][0]]}%), seguido por ${w[N[1][0]]} (${k.event_percentages[N[1][0]]}%).`)})]})})]}),k.sessions_early&&k.sessions_recent&&k.total_sessions>=4&&(0,s.jsx)(v,{type:"auto",children:(0,s.jsxs)("div",{className:"p-5",style:{backgroundColor:"#f8fafc"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide",children:"Comparativo Temporal"}),(0,s.jsx)(y,{type:"auto"})]}),(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,s.jsx)("th",{className:"text-left py-2 text-gray-500 font-medium",children:"Período"}),(0,s.jsx)("th",{className:"text-center py-2 text-gray-500 font-medium",children:"Sessões"}),(0,s.jsx)("th",{className:"text-center py-2 text-gray-500 font-medium",children:"Eventos"}),(0,s.jsx)("th",{className:"text-center py-2 text-gray-500 font-medium",children:"Recuperação"})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,s.jsx)("td",{className:"py-3 text-gray-700",children:"Sessões iniciais"}),(0,s.jsx)("td",{className:"py-3 text-center text-gray-600",children:k.sessions_early.count}),(0,s.jsx)("td",{className:"py-3 text-center text-gray-600",children:k.sessions_early.events}),(0,s.jsxs)("td",{className:"py-3 text-center text-gray-600",children:[k.sessions_early.avg_recovery," min"]})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"py-3 text-gray-700",children:"Sessões recentes"}),(0,s.jsx)("td",{className:"py-3 text-center text-gray-600",children:k.sessions_recent.count}),(0,s.jsx)("td",{className:"py-3 text-center text-gray-600",children:k.sessions_recent.events}),(0,s.jsxs)("td",{className:"py-3 text-center text-gray-600",children:[k.sessions_recent.avg_recovery," min"]})]})]})]})]})}),k.outlier_sessions&&k.outlier_sessions.length>0&&(0,s.jsx)(v,{type:"attention",children:(0,s.jsxs)("div",{className:"p-5",style:{backgroundColor:"#fffbeb"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium uppercase tracking-wide flex items-center gap-2",style:{color:"#92400e"},children:[(0,s.jsx)(u.AlertTriangle,{className:"w-4 h-4"}),"Sessões com Variação"]}),(0,s.jsx)(y,{type:"attention"})]}),(0,s.jsx)("ul",{className:"space-y-1",children:k.outlier_sessions.map((e,t)=>(0,s.jsxs)("li",{className:"text-sm",style:{color:"#92400e"},children:[(0,s.jsxs)("span",{className:"font-medium",children:["Sessão #",e.session_number]})," — ",e.reason]},t))})]})}),(0,s.jsx)(v,{type:"auto",children:(0,s.jsxs)("div",{className:"p-5",style:{backgroundColor:"#f8fafc"},children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide mb-4 flex items-center gap-2",children:[(0,s.jsx)(p.Calendar,{className:"w-4 h-4 text-gray-400"}),"Linha do Tempo"]}),0===k.timeline.length?(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"Nenhuma sessão finalizada"}):(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute left-3 top-0 bottom-0 w-px bg-gray-300"}),(0,s.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:k.timeline.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-3 relative pl-8",children:[(0,s.jsx)("div",{className:"absolute left-0 w-6 h-6 bg-white border-2 border-gray-300 rounded-full flex items-center justify-center text-xs text-gray-600 font-medium",children:e.session_number}),(0,s.jsxs)("div",{className:"flex-1 bg-white rounded-lg p-2 border border-gray-200",children:[(0,s.jsx)("span",{className:"text-sm text-gray-700",children:new Date(e.date).toLocaleDateString("pt-BR")}),(0,s.jsx)("span",{className:"text-xs text-gray-400 ml-2",children:e.duration?`${e.duration} min`:""})]})]},t))})]})]})}),(0,s.jsx)(v,{type:"professional",children:(0,s.jsxs)("div",{className:"p-5 bg-white",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("h3",{className:"text-sm font-medium text-gray-900 uppercase tracking-wide flex items-center gap-2",children:[(0,s.jsx)(g.MessageSquare,{className:"w-4 h-4 text-gray-400"}),"Contexto para supervisão"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(y,{type:"professional"}),(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:R,onChange:e=>O(e.target.checked),className:"w-4 h-4 text-green-600 rounded border-gray-300"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"Incluir"})]})]})]}),R&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("textarea",{value:U,onChange:e=>L(e.target.value.slice(0,800)),placeholder:"Informações clínicas relevantes para supervisão...",className:"w-full h-24 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 resize-none"}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:[U.length,"/800"]}),(0,s.jsx)("button",{onClick:I,disabled:$,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all",style:{backgroundColor:A?"#f0fdf4":"#f8fafc",color:A?"#16a34a":"#64748b",border:`1px solid ${A?"#bbf7d0":"#e2e8f0"}`},children:$?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Salvando..."]}):A?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Check,{className:"w-3 h-3"}),"Salvo"]}):"Salvar contexto"})]})]})]})}),(0,s.jsx)("div",{className:"flex justify-center pt-2",children:(0,s.jsxs)("button",{onClick:()=>{fetch("/api/audit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"REPORT_EXPORT",entity_type:"report",entity_id:e,metadata:{format:"pdf",sessions_count:k?.total_sessions}})}),window.open(`/relatorio/${e}`,"_blank")},className:"flex items-center gap-2 px-6 py-3 text-white rounded-xl text-sm font-medium transition-all hover:opacity-90",style:{backgroundColor:"#16a34a"},children:[(0,s.jsx)(j,{className:"w-4 h-4"}),"Exportar PDF"]})})]}),(0,s.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100",children:(0,s.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"Este relatório não substitui avaliação clínica profissional. Interpretação exclusiva do profissional responsável."})})]})}function w(){let e=(0,r.useRouter)(),i=(0,r.useParams)().id,{isLoaded:o,userId:c}=(0,a.useAuth)(),[d,x]=(0,t.useState)(null),[m,h]=(0,t.useState)([]),[u,p]=(0,t.useState)(!0),[g,j]=(0,t.useState)(!1),[f,b]=(0,t.useState)(!1),[v,y]=(0,t.useState)(!1),[w,k]=(0,t.useState)(!1),[C,E]=(0,t.useState)({}),[_,S]=(0,t.useState)(!1),[T,R]=(0,t.useState)(""),[O,U]=(0,t.useState)(!1),[L,$]=(0,t.useState)(!1),[P,A]=(0,t.useState)(!1),[M,z]=(0,t.useState)(null),[I,D]=(0,t.useState)(!1),[B,V]=(0,t.useState)(!1),[W,F]=(0,t.useState)("record"),[J,H]=(0,t.useState)(!1),[G,q]=(0,t.useState)(null),[X,K]=(0,t.useState)(!1),[Z,Q]=(0,t.useState)(!1),[Y,ee]=(0,t.useState)({complaint:"",patterns:"",interventions:"",current_state:"",transcript:""}),[es,et]=(0,t.useState)(!1),ea=(0,t.useRef)(null),er=(0,t.useRef)([]),el=(0,t.useRef)(null);(0,t.useEffect)(()=>{o&&c&&i&&(en(),ei())},[o,c,i]);let en=async()=>{try{p(!0);let[e,s]=await Promise.all([fetch(`/api/patients/${i}`),fetch(`/api/patients/${i}/sessions`)]);if(e.ok){let s=await e.json();x(s.patient)}if(s.ok){let e=await s.json();h(e.sessions||[])}}catch(e){console.error("Erro:",e)}finally{p(!1)}},ei=async()=>{try{let e=await fetch(`/api/patients/${i}/clinical-record`);if(e.ok){let s=await e.json();D(s.exists),s.exists&&z(s.record)}}catch(e){console.error("Erro ao carregar registro clínico:",e)}},eo=async()=>{y(!0);try{(await fetch(`/api/patients/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)})).ok&&(j(!1),en())}catch(e){console.error("Erro:",e)}finally{y(!1)}},ec=async()=>{k(!0);try{(await fetch(`/api/patients/${i}`,{method:"DELETE"})).ok&&e.push("/pacientes")}catch(e){console.error("Erro:",e)}finally{k(!1)}},ed=async()=>{U(!0);try{let e=await fetch(`/api/patients/${i}/push-link`,{method:"POST"});if(e.ok){let s=await e.json();R(s.link),S(!0)}}catch(e){console.error("Erro:",e)}finally{U(!1)}},ex=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),s=new MediaRecorder(e);ea.current=s,er.current=[],s.ondataavailable=e=>er.current.push(e.data),s.onstop=()=>{let s=new Blob(er.current,{type:"audio/webm"});q(s),e.getTracks().forEach(e=>e.stop())},s.start(),H(!0)}catch(e){console.error("Erro ao iniciar gravação:",e),alert("Não foi possível acessar o microfone")}},em=async()=>{if(G){K(!0);try{let e=new FormData;e.append("audio",G,"clinical_record.webm");let s=await fetch("/api/transcribe-audio",{method:"POST",body:e});if(!s.ok)throw Error("Erro na transcrição");let t=(await s.json()).text;ee(e=>({...e,transcript:t})),K(!1),Q(!0);let a=await fetch("/api/analyze-clinical",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:t,patientName:d?.full_name})});if(a.ok){let e=await a.json();ee({complaint:e.complaint||"",patterns:e.patterns||"",interventions:e.interventions||"",current_state:e.current_state||"",transcript:t})}F("review")}catch(e){console.error("Erro ao processar áudio:",e),alert("Erro ao processar áudio")}finally{K(!1),Q(!1)}}},eh=async()=>{et(!0);try{(await fetch(`/api/patients/${i}/clinical-record`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:Y.complaint,patterns:Y.patterns,interventions:Y.interventions,current_state:Y.current_state,original_transcript:Y.transcript})})).ok&&(V(!1),F("record"),q(null),ee({complaint:"",patterns:"",interventions:"",current_state:"",transcript:""}),ei())}catch(e){console.error("Erro ao salvar:",e)}finally{et(!1)}};return!o||u?(0,s.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,s.jsx)(n.default,{}),(0,s.jsx)("main",{className:"md:ml-20 min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-6 h-6 border-2 border-sky-500 border-t-transparent rounded-full animate-spin"})})]}):d?(0,s.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,s.jsx)(n.default,{}),(0,s.jsx)("main",{className:"md:ml-20 min-h-screen pb-20 md:pb-8",children:(0,s.jsx)("div",{className:"px-4 md:px-8 lg:px-12 xl:px-16 pt-6",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)(l.default,{href:"/pacientes",className:"inline-flex items-center gap-2 text-slate-500 hover:text-sky-600 transition-colors mb-6 text-sm",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Voltar"]}),(0,s.jsxs)("header",{className:"flex items-start justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"font-serif text-3xl md:text-4xl font-light text-slate-900 tracking-tight mb-1",children:d.name||d.full_name}),(0,s.jsx)("p",{className:"text-base text-slate-400 italic font-light",children:"Informações e histórico do paciente"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[m.filter(e=>"finalizada"===e.status).length>=3&&(0,s.jsxs)("button",{onClick:()=>A(!P),className:"flex items-center gap-2 px-4 py-2 bg-emerald-50 text-emerald-600 border border-emerald-300 rounded-lg hover:bg-emerald-100 transition-colors text-sm font-medium",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Evolução"]}),(0,s.jsxs)("button",{onClick:ed,disabled:O,className:"flex items-center gap-2 px-4 py-2 bg-amber-50 text-amber-600 border border-amber-300 rounded-lg hover:bg-amber-100 transition-colors text-sm font-medium disabled:opacity-50",children:[O?(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-amber-500 border-t-transparent rounded-full animate-spin"}):(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),"Lembretes"]}),(0,s.jsxs)("button",{onClick:()=>{E({name:d?.full_name||"",email:d?.email||"",phone:d?.phone||"",birth_date:d?.birth_date?d.birth_date.split("T")[0]:"",gender:d?.gender||"",diagnosis:d?.diagnosis||"",medication:d?.medication||"",notes:d?.notes||""}),j(!0)},className:"flex items-center gap-2 px-4 py-2 bg-sky-50 text-sky-600 border border-sky-300 rounded-lg hover:bg-sky-100 transition-colors text-sm font-medium",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Editar"]}),(0,s.jsxs)("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-600 border border-slate-300 rounded-lg hover:bg-slate-200 transition-colors text-sm font-medium",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Excluir"]})]})]}),(0,s.jsxs)("section",{className:"grid grid-cols-3 gap-4 mb-6 pb-6 border-b border-slate-100",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 uppercase tracking-wider mb-1",children:"Email"}),(0,s.jsx)("p",{className:"text-slate-900 text-sm",children:d.email||"-"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 uppercase tracking-wider mb-1",children:"Telefone"}),(0,s.jsx)("p",{className:"text-slate-900 text-sm",children:(e=>{if(!e)return"-";let s=e.replace(/\D/g,"");return 11===s.length?`(${s.slice(0,2)}) ${s.slice(2,7)}-${s.slice(7)}`:10===s.length?`(${s.slice(0,2)}) ${s.slice(2,6)}-${s.slice(6)}`:e})(d.phone)})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 uppercase tracking-wider mb-1",children:"Data de Nascimento"}),(0,s.jsx)("p",{className:"text-slate-900 text-sm",children:d.birth_date?new Date(d.birth_date).toLocaleDateString("pt-BR"):"-"})]})]}),!I&&(0,s.jsx)("section",{className:"bg-sky-50 border border-sky-200 rounded-lg p-4 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-sky-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-sky-900 text-sm",children:"Registro Clínico Assistido"}),(0,s.jsx)("p",{className:"text-xs text-sky-700",children:"Para pacientes com histórico terapêutico anterior ao uso do AXIS"})]})]}),(0,s.jsx)("button",{onClick:()=>V(!0),className:"px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 text-sm font-medium transition-colors",children:"Registrar histórico"})]})}),I&&M&&(0,s.jsxs)("section",{className:"bg-slate-50 border border-slate-200 rounded-lg p-5 mb-6",children:[(0,s.jsx)("h3",{className:"font-medium text-slate-800 mb-1 text-sm",children:"Contexto Clínico Inicial"}),(0,s.jsx)("p",{className:"text-xs text-slate-400 mb-4",children:"Registro retrospectivo informado pelo profissional antes do início das sessões no sistema."}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[M.complaint&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:"Evento ou contexto inicial"}),(0,s.jsx)("p",{className:"text-sm text-slate-800",children:M.complaint})]}),M.patterns&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:"Aspectos mencionados no histórico"}),(0,s.jsx)("p",{className:"text-sm text-slate-800",children:M.patterns})]}),M.interventions&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:"Intervenções prévias relatadas"}),(0,s.jsx)("p",{className:"text-sm text-slate-800",children:M.interventions})]}),M.current_state&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:"Situação atual conforme relato"}),(0,s.jsx)("p",{className:"text-sm text-slate-800",children:M.current_state})]})]})]}),(d.diagnosis||d.medication||d.notes||d.gender)&&(0,s.jsxs)("section",{className:"mb-6 pb-6 border-b border-slate-100",children:[(0,s.jsx)("h2",{className:"font-serif text-xl font-light text-slate-800 mb-4",children:"Informações Clínicas"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.gender&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 mb-1",children:"Gênero"}),(0,s.jsx)("p",{className:"text-sm text-slate-800",children:d.gender})]}),d.diagnosis&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 mb-1",children:"Diagnóstico"}),(0,s.jsx)("p",{className:"text-sm text-slate-800",children:d.diagnosis})]}),d.medication&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 mb-1",children:"Medicação"}),(0,s.jsx)("p",{className:"text-sm text-slate-800",children:d.medication})]}),d.notes&&(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 mb-1",children:"Observações"}),(0,s.jsx)("p",{className:"text-sm text-slate-800",children:d.notes})]})]})]}),P&&(0,s.jsx)("div",{id:"evolution-report",children:(0,s.jsx)(N,{patientId:i,sessionsCount:m.filter(e=>"finalizada"===e.status).length,onClose:()=>A(!1)})}),(0,s.jsxs)("section",{children:[(0,s.jsxs)("h2",{className:"font-serif text-xl font-light text-slate-800 mb-4",children:["Histórico de Sessões (",m.length,")"]}),0===m.length?(0,s.jsx)("p",{className:"text-slate-400 italic text-sm",children:"Nenhuma sessão registrada"}):(0,s.jsxs)("div",{className:"w-full overflow-x-auto",children:[(0,s.jsxs)("div",{className:"hidden md:grid grid-cols-12 gap-4 pb-3 border-b border-slate-200 text-xs uppercase tracking-wider text-slate-400 font-medium",children:[(0,s.jsx)("div",{className:"col-span-1",children:"#"}),(0,s.jsx)("div",{className:"col-span-3",children:"Data"}),(0,s.jsx)("div",{className:"col-span-4",children:"Status"}),(0,s.jsx)("div",{className:"col-span-4",children:"Duração"})]}),(0,s.jsx)("div",{className:"flex flex-col",children:m.map(t=>(0,s.jsxs)("div",{onClick:()=>e.push(`/sessoes/${t.id}`),className:"grid grid-cols-12 gap-4 py-3 items-center hover:bg-slate-50/50 transition-colors cursor-pointer border-b border-slate-100",children:[(0,s.jsx)("div",{className:"col-span-1 text-sm text-slate-600",children:t.session_number}),(0,s.jsx)("div",{className:"col-span-3 text-sm text-slate-700",children:new Date(t.scheduled_at||t.started_at||t.created_at).toLocaleDateString("pt-BR")}),(0,s.jsx)("div",{className:"col-span-4",children:(0,s.jsx)("span",{className:`text-sm ${(e=>{switch(e){case"em_andamento":return"text-sky-600";case"agendada":return"text-amber-600";default:return"text-slate-500"}})(t.status)}`,children:(e=>{switch(e){case"em_andamento":return"Em andamento";case"agendada":return"Agendada";case"finalizada":return"Finalizada";default:return e}})(t.status)})}),(0,s.jsx)("div",{className:"col-span-4 text-sm text-slate-500",children:t.duration_minutes?`${t.duration_minutes} min`:"-"})]},t.id))})]})]})]})})}),_&&(0,s.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-100",children:[(0,s.jsx)("h3",{className:"font-serif text-xl font-light text-slate-900",children:"Link de Lembretes"}),(0,s.jsx)("button",{onClick:()=>S(!1),className:"text-slate-400 hover:text-slate-600",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Envie este link para o paciente ativar lembretes no celular:"}),(0,s.jsx)("div",{className:"bg-slate-100 p-3 rounded-lg mb-4 break-all text-sm font-mono text-slate-700",children:T}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(T),$(!0),setTimeout(()=>$(!1),2e3)},className:"flex-1 px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 text-sm font-medium",children:L?"Copiado!":"Copiar Link"}),(0,s.jsx)("a",{href:`https://wa.me/?text=${encodeURIComponent("Olá! Ative seus lembretes de sessão: "+T)}`,target:"_blank",className:"flex-1 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 text-sm font-medium text-center",children:"Enviar WhatsApp"})]}),(0,s.jsx)("p",{className:"text-xs text-slate-400 mt-3",children:"O paciente só receberá lembretes logísticos (data/hora). Nenhuma informação clínica será enviada."})]})]})}),g&&(0,s.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-100",children:[(0,s.jsx)("h3",{className:"font-serif text-xl font-light text-slate-900",children:"Editar Paciente"}),(0,s.jsx)("button",{onClick:()=>j(!1),className:"text-slate-400 hover:text-slate-600",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"p-6 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nome"}),(0,s.jsx)("input",{type:"text",value:C.name,onChange:e=>E({...C,name:e.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email"}),(0,s.jsx)("input",{type:"email",value:C.email,onChange:e=>E({...C,email:e.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Telefone"}),(0,s.jsx)("input",{type:"tel",value:C.phone,onChange:e=>E({...C,phone:e.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Data de Nascimento"}),(0,s.jsx)("input",{type:"date",value:C.birth_date,onChange:e=>E({...C,birth_date:e.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Gênero"}),(0,s.jsx)("input",{type:"text",value:C.gender,onChange:e=>E({...C,gender:e.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Diagnóstico"}),(0,s.jsx)("input",{type:"text",value:C.diagnosis,onChange:e=>E({...C,diagnosis:e.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Medicação"}),(0,s.jsx)("input",{type:"text",value:C.medication,onChange:e=>E({...C,medication:e.target.value}),className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Observações"}),(0,s.jsx)("textarea",{value:C.notes,onChange:e=>E({...C,notes:e.target.value}),rows:3,className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm resize-none"})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 p-6 border-t border-slate-100 bg-slate-50 rounded-b-xl",children:[(0,s.jsx)("button",{onClick:()=>j(!1),className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg hover:bg-slate-100 text-sm text-slate-600",children:"Cancelar"}),(0,s.jsx)("button",{onClick:eo,disabled:v,className:"flex-1 px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 disabled:opacity-50 text-sm font-medium",children:v?"Salvando...":"Salvar"})]})]})}),f&&(0,s.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 p-4",children:(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-xl max-w-sm w-full",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"font-serif text-xl font-light text-slate-900 mb-2",children:"Excluir Paciente"}),(0,s.jsxs)("p",{className:"text-slate-600 text-sm mb-6",children:["Tem certeza que deseja excluir ",(0,s.jsx)("strong",{children:d.full_name}),"? Esta ação não pode ser desfeita."]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>b(!1),className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg hover:bg-slate-100 text-sm text-slate-600",children:"Cancelar"}),(0,s.jsx)("button",{onClick:ec,disabled:w,className:"flex-1 px-4 py-2 bg-rose-500 text-white rounded-lg hover:bg-rose-600 disabled:opacity-50 text-sm font-medium",children:w?"Excluindo...":"Excluir"})]})]})})}),B&&(0,s.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-100",children:[(0,s.jsx)("h3",{className:"font-serif text-xl font-light text-slate-900",children:"Registro Clínico Assistido"}),(0,s.jsx)("button",{onClick:()=>{V(!1),F("record"),q(null)},className:"text-slate-400 hover:text-slate-600",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),"record"===W&&(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("p",{className:"text-sm text-slate-600 mb-2",children:"Grave ou importe um resumo clínico inicial com base no seu conhecimento prévio do paciente."}),(0,s.jsx)("p",{className:"text-xs text-slate-400 mb-6",children:"Inclua contexto inicial, intervenções prévias e situação atual."}),(0,s.jsx)("input",{type:"file",ref:el,accept:"audio/*",onChange:e=>{let s=e.target.files?.[0];s&&q(s)},className:"hidden"}),(0,s.jsx)("div",{className:"flex flex-col items-center gap-4",children:G?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-emerald-600",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,s.jsx)("span",{className:"text-sm",children:"Áudio pronto"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>q(null),className:"px-4 py-2 border border-slate-200 rounded-lg hover:bg-slate-50 text-sm text-slate-600",children:"Escolher outro"}),(0,s.jsxs)("button",{onClick:em,disabled:X||Z,className:"px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 disabled:opacity-50 text-sm font-medium flex items-center gap-2",children:[(X||Z)&&(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),X?"Transcrevendo...":Z?"Analisando...":"Processar"]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-6",children:[J?(0,s.jsx)("button",{onClick:()=>{ea.current&&J&&(ea.current.stop(),H(!1))},className:"w-20 h-20 rounded-full bg-rose-600 animate-pulse flex items-center justify-center text-white",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("rect",{x:"6",y:"6",width:"12",height:"12"})})}):(0,s.jsx)("button",{onClick:ex,className:"w-20 h-20 rounded-full bg-rose-500 hover:bg-rose-600 flex items-center justify-center text-white transition-colors",children:(0,s.jsx)("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),(0,s.jsx)("button",{onClick:()=>el.current?.click(),className:"w-14 h-14 rounded-full bg-slate-200 hover:bg-slate-300 flex items-center justify-center text-slate-600 transition-colors",title:"Importar áudio",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})})]}),(0,s.jsx)("p",{className:"text-sm text-slate-500",children:J?"Gravando... Clique para parar":"Grave ou importe um áudio"})]})})]}),"review"===W&&(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Resumo clínico preliminar gerado. Revise e edite se necessário."}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Evento ou contexto inicial"}),(0,s.jsx)("textarea",{value:Y.complaint,onChange:e=>ee({...Y,complaint:e.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm resize-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Aspectos mencionados no histórico"}),(0,s.jsx)("textarea",{value:Y.patterns,onChange:e=>ee({...Y,patterns:e.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm resize-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Intervenções prévias relatadas"}),(0,s.jsx)("textarea",{value:Y.interventions,onChange:e=>ee({...Y,interventions:e.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm resize-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Situação atual conforme relato"}),(0,s.jsx)("textarea",{value:Y.current_state,onChange:e=>ee({...Y,current_state:e.target.value}),rows:2,className:"w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 text-sm resize-none"})]})]}),(0,s.jsx)("p",{className:"text-xs text-slate-400 mt-4 italic",children:"Este registro é descritivo, retrospectivo e não substitui sessões clínicas."}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)("button",{onClick:()=>{F("record"),q(null)},className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg hover:bg-slate-50 text-sm text-slate-600",children:"Voltar"}),(0,s.jsx)("button",{onClick:eh,disabled:es,className:"flex-1 px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 disabled:opacity-50 text-sm font-medium",children:es?"Salvando...":"Confirmar e salvar"})]})]})]})})]}):(0,s.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,s.jsx)(n.default,{}),(0,s.jsx)("main",{className:"md:ml-20 min-h-screen flex items-center justify-center",children:(0,s.jsx)("p",{className:"text-slate-500 italic",children:"Paciente não encontrado"})})]})}e.s(["default",()=>w],79870)}]);